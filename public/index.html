<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Portal - Commercial Real Estate Brokerage</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Elite Professional Color Palette */
            --primary: #0a1629;
            --primary-dark: #050a14;
            --primary-light: #1a2332;
            --accent: #1e40af;
            --accent-light: #3b82f6;
            --text-primary: #0f172a;
            --text-secondary: #334155;
            --text-light: #64748b;
            --text-muted: #94a3b8;
            --border: #cbd5e1;
            --border-light: #e2e8f0;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --success: #059669;
            --error: #dc2626;
            --info: #0284c7;
            
            /* Sophisticated Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.04);
            
            /* Typography Scale - Consistent Sizing */
            --font-size-xs: 11px;
            --font-size-sm: 12px;
            --font-size-base: 14px;
            --font-size-md: 15px;
            --font-size-lg: 16px;
            --font-size-xl: 18px;
            --font-size-2xl: 20px;
            --font-size-3xl: 24px;
            --font-size-4xl: 28px;
            
            /* Font Weights */
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
            
            /* Line Heights */
            --line-height-tight: 1.3;
            --line-height-normal: 1.5;
            --line-height-relaxed: 1.6;
            --line-height-loose: 1.7;
            
            /* Spacing Scale - Consistent Padding/Margins */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 40px;
            --space-3xl: 48px;
            --space-4xl: 56px;
            --space-5xl: 64px;
            
            /* Component Padding */
            --padding-xs: 8px 12px;
            --padding-sm: 12px 16px;
            --padding-md: 16px 20px;
            --padding-lg: 20px 24px;
            --padding-xl: 24px 32px;
            --padding-2xl: 32px 40px;
            --padding-3xl: 40px 48px;
            --padding-4xl: 48px 56px;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #ffffff;
            color: var(--text-primary);
            line-height: var(--line-height-normal);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-normal);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            letter-spacing: -0.011em;
        }

        /* Typography Hierarchy - Consistent Headings */
        h1, .h1 {
            font-size: var(--font-size-4xl);
            font-weight: var(--font-weight-semibold);
            line-height: var(--line-height-tight);
            letter-spacing: -0.3px;
            margin: 0;
        }

        h2, .h2 {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-semibold);
            line-height: var(--line-height-tight);
            letter-spacing: -0.2px;
            margin: 0;
        }

        h3, .h3 {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-semibold);
            line-height: var(--line-height-tight);
            letter-spacing: -0.1px;
            margin: 0;
        }

        h4, .h4 {
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-semibold);
            line-height: var(--line-height-normal);
            letter-spacing: 0;
            margin: 0;
        }

        p, .p {
            font-size: var(--font-size-base);
            line-height: var(--line-height-relaxed);
            margin: 0;
        }

        small, .small {
            font-size: var(--font-size-sm);
            line-height: var(--line-height-normal);
        }

        .application-wrapper {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Portal Top Bar */
        .portal-topbar {
            position: sticky;
            top: 0;
            z-index: 200;
            background: #ffffff;
            border-bottom: 1px solid var(--border);
            padding: 0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .security-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .portal-topbar-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 18px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .portal-brand {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .portal-logo {
            width: 36px;
            height: 36px;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
            letter-spacing: 0.5px;
        }

        .portal-brand-text {
            display: flex;
            flex-direction: column;
        }

        .portal-brand-name {
            font-size: 17px;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.3;
            letter-spacing: -0.2px;
        }

        .portal-brand-subtitle {
            font-size: 12px;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 0.3px;
            font-weight: 400;
        }

        /* Progress Bar */
        .progress-container {
            position: relative;
            z-index: 100;
            background: #ffffff;
            border-bottom: 1px solid var(--border-light);
        }

        .progress-bar {
            height: 2px;
            background: var(--border-light);
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0%;
        }

        .progress-info {
            max-width: 1200px;
            margin: 0 auto;
            padding: 18px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-text {
            font-size: 11px;
            color: var(--text-primary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .progress-percentage {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Header */
        .header {
            background: var(--primary);
            color: #ffffff;
            padding: 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-5xl) var(--space-2xl) var(--space-3xl);
            position: relative;
            z-index: 10;
        }

        .header h1 {
            font-size: var(--font-size-4xl);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--space-sm);
            line-height: var(--line-height-tight);
            color: #ffffff !important;
            opacity: 1 !important;
            position: relative;
            z-index: 10;
            letter-spacing: -0.3px;
        }

        .header p {
            font-size: var(--font-size-base);
            color: rgba(255, 255, 255, 0.9) !important;
            font-weight: var(--font-weight-normal);
            line-height: var(--line-height-normal);
            max-width: 700px;
            opacity: 1 !important;
            position: relative;
            z-index: 10;
            letter-spacing: 0;
        }

        /* Main Container */
        .main-container {
            flex: 1;
            max-width: 1400px;
            margin: 0 auto var(--space-5xl);
            padding: 0 var(--space-2xl);
            position: relative;
            z-index: 1;
            scroll-padding-top: 120px;
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
            -webkit-text-size-adjust: 100%;
            scroll-padding-top: 120px;
        }

        body {
            scroll-padding-top: 120px;
        }

        /* Section visibility animations - handled below */


        /* Navigation Sidebar */
        .nav-sidebar {
            position: sticky;
            top: 100px;
            align-self: start;
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: 0;
            padding: var(--space-lg);
            margin-bottom: var(--space-xl);
            box-shadow: var(--shadow-sm);
            transition: box-shadow 0.3s ease, border-color 0.3s ease;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--border) transparent;
        }

        .nav-sidebar:hover {
            box-shadow: var(--shadow-md);
        }

        .nav-sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .nav-sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .nav-sidebar::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        .nav-sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--text-light);
        }

        .nav-sidebar h3 {
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-bold);
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: var(--space-md);
        }

        .nav-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .nav-item {
            margin-bottom: var(--space-sm);
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: var(--space-sm) var(--space-md);
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 0;
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            transition: background 0.3s ease, color 0.3s ease, transform 0.2s ease, padding-left 0.3s ease;
            cursor: pointer;
            border-left: 3px solid transparent;
            position: relative;
        }

        .nav-link:hover {
            background: var(--bg-light);
            color: var(--primary);
        }

        .nav-link.active {
            background: var(--bg-light);
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 500;
            border-left: 3px solid var(--primary);
            padding-left: 9px;
        }

        .nav-link.completed::before {
            content: 'Complete';
            margin-right: var(--space-sm);
            color: var(--text-secondary);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-medium);
            text-transform: uppercase;
        }

        .nav-link.completed.active::before {
            color: var(--primary);
        }

        /* Layout */
        .content-layout {
            display: grid;
            grid-template-columns: 240px 1fr;
            gap: var(--space-xl);
            align-items: start;
        }

        /* Position Card - Premium Glassmorphism */
        .position-card {
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: 0;
            margin-bottom: var(--space-xl);
            box-shadow: none;
        }

        .position-card-header {
            background: var(--bg-white);
            padding: var(--space-2xl);
            border-bottom: 1px solid var(--border);
        }

        .position-card-header h2 {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
            line-height: var(--line-height-tight);
            letter-spacing: -0.3px;
        }

        .position-card-header p {
            color: var(--text-secondary);
            font-size: var(--font-size-md);
            line-height: var(--line-height-loose);
            margin: 0;
            font-weight: var(--font-weight-normal);
        }

        /* Position Details Sections */
        .position-details {
            margin-top: var(--space-lg);
            padding-top: var(--space-lg);
            border-top: 1px solid var(--border);
        }

        .position-detail-section {
            margin-bottom: var(--space-2xl);
            padding-bottom: var(--space-xl);
            border-bottom: 1px solid var(--border-light);
        }

        .position-detail-section:last-child {
            border-bottom: none;
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .position-detail-section h3 {
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-md);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding-bottom: var(--space-sm);
            border-bottom: 2px solid var(--primary);
            display: inline-block;
        }

        .position-detail-section p {
            line-height: var(--line-height-relaxed);
            color: var(--text-secondary);
            font-size: var(--font-size-base);
            margin-bottom: var(--space-md);
            font-weight: var(--font-weight-normal);
        }

        .position-detail-section p:last-child {
            margin-bottom: 0;
        }

        .position-detail-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .position-detail-section li {
            padding: var(--space-sm) 0 var(--space-sm) var(--space-xl);
            position: relative;
            color: var(--text-secondary);
            line-height: var(--line-height-relaxed);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-normal);
        }

        .position-detail-section li::before {
            content: '';
            position: absolute;
            left: var(--space-md);
            top: 14px;
            width: 6px;
            height: 6px;
            background: var(--primary);
            border-radius: 50%;
        }

        .company-details {
            padding: 40px;
            border-top: 1px solid var(--border);
        }

        .company-section {
            margin-bottom: 32px;
        }

        .company-section:last-child {
            margin-bottom: 0;
        }

        .company-section h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .company-section p {
            color: var(--text-secondary);
            line-height: 1.7;
            font-size: 15px;
            margin-bottom: 16px;
        }

        .company-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .company-section li {
            padding: 8px 0 8px 24px;
            position: relative;
            color: var(--text-secondary);
            line-height: 1.7;
            font-size: 15px;
        }

        .company-section li::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 14px;
            width: 6px;
            height: 6px;
            background: var(--primary);
            border-radius: 50%;
        }

        .job-description {
            padding: var(--space-2xl);
        }

        .job-section {
            margin-bottom: var(--space-xl);
        }

        .job-section:last-child {
            margin-bottom: 0;
        }

        .job-section h3 {
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-semibold);
            color: var(--primary);
            margin-bottom: var(--space-md);
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .job-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .job-section li {
            padding: var(--space-sm) 0 var(--space-sm) var(--space-lg);
            position: relative;
            color: var(--text-secondary);
            line-height: var(--line-height-loose);
            font-size: var(--font-size-md);
        }

        .job-section li::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 14px;
            width: 6px;
            height: 6px;
            background: var(--primary);
            border-radius: 50%;
        }

        .job-note {
            margin-top: var(--space-xl);
            padding: var(--space-md) var(--space-lg);
            background: var(--bg-light);
            border-left: 3px solid var(--primary);
            border-radius: 4px;
        }

        .job-note p {
            margin: 0;
            color: var(--text-primary);
            line-height: var(--line-height-loose);
            font-size: var(--font-size-base);
        }

        .job-note strong {
            color: var(--primary);
            font-weight: var(--font-weight-semibold);
        }

        /* Form Card */
        .form-card {
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: 0;
            overflow: hidden;
            box-shadow: none;
        }

        .form-content {
            padding: var(--space-4xl);
            position: relative;
        }

        .portal-welcome {
            margin-bottom: var(--space-xl);
            padding-bottom: var(--space-lg);
            border-bottom: 1px solid var(--border);
            position: relative;
        }

        .portal-welcome::after {
            display: none;
        }

        .portal-welcome h2 {
            font-size: var(--font-size-xs) !important;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-sm) !important;
            line-height: var(--line-height-tight);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .portal-welcome > p {
            font-size: var(--font-size-sm) !important;
            color: var(--text-secondary);
            line-height: var(--line-height-normal) !important;
            max-width: 900px;
            font-weight: var(--font-weight-normal);
            margin-bottom: var(--space-md) !important;
        }

        .form-completion-notice {
            background: var(--bg-light);
            border: 1px solid var(--border);
            border-left: 2px solid var(--primary);
            padding: var(--space-sm) var(--space-md) !important;
            margin: var(--space-md) 0 var(--space-sm) 0 !important;
        }

        .form-completion-notice p {
            font-size: var(--font-size-xs) !important;
            color: var(--text-secondary);
            line-height: var(--line-height-tight) !important;
            margin: 0;
        }

        .form-completion-notice strong {
            color: var(--text-primary);
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-size-xs);
        }

        .last-save-info {
            display: none;
            margin-top: var(--space-sm) !important;
            margin-bottom: 0;
            padding: var(--space-xs) var(--space-sm) !important;
            background: rgba(5, 150, 105, 0.05);
            border: 1px solid rgba(5, 150, 105, 0.15);
            border-left: 2px solid var(--success);
            font-size: var(--font-size-xs) !important;
            color: var(--success);
            font-weight: var(--font-weight-medium);
        }

        .portal-welcome-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md) !important;
            margin-top: var(--space-md) !important;
            padding-top: var(--space-md) !important;
            border-top: 1px solid var(--border);
        }

        .portal-feature {
            display: block;
        }

        .portal-feature-icon {
            display: none;
        }

        .portal-feature-content h4 {
            font-size: var(--font-size-xs) !important;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-xs) !important;
            letter-spacing: 0.3px;
            line-height: var(--line-height-tight);
            text-transform: uppercase;
        }

        .portal-feature-content p {
            font-size: var(--font-size-xs) !important;
            color: var(--text-secondary);
            line-height: var(--line-height-tight) !important;
            margin: 0;
        }

        /* Help Tooltips */
        .help-tooltip {
            position: relative;
            display: inline-flex;
            align-items: center;
            margin-left: 6px;
            cursor: help;
        }

        .help-icon {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--bg-light);
            border: 1.5px solid var(--border);
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
            transition: all 0.2s ease;
        }

        .help-tooltip:hover .help-icon {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .help-tooltip-content {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
            padding: 10px 14px;
            background: var(--text-primary);
            color: white;
            border-radius: 8px;
            font-size: 12px;
            line-height: 1.5;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: all 0.2s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .help-tooltip-content::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--text-primary);
        }

        .help-tooltip:hover .help-tooltip-content {
            opacity: 1;
            pointer-events: auto;
        }

        /* Section Completion Indicators */
        .section-completion {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
            font-size: 12px;
            color: var(--text-light);
            font-weight: 500;
        }

        .section-completion-icon {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
            transition: all 0.3s ease;
        }

        .section-completion-icon.complete {
            background: var(--success);
            color: white;
        }

        .section-completion-icon.incomplete {
            background: var(--bg-light);
            border: 2px solid var(--border);
            color: var(--text-muted);
        }

        /* Estimated Time Indicators */
        .estimated-time {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: var(--text-light);
            font-weight: 500;
            margin-left: 12px;
        }

        .estimated-time-icon {
            width: 14px;
            height: 14px;
        }

        /* Application Summary Modal */
        .summary-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .summary-modal.active {
            display: flex;
        }

        .summary-modal-content {
            background: white;
            border-radius: 20px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 24px 80px rgba(0, 0, 0, 0.3);
            animation: modalSlideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .summary-modal-header {
            padding: var(--space-xl) var(--space-2xl) var(--space-lg);
            border-bottom: 1px solid var(--border-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .summary-modal-header h3 {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-bold);
            color: var(--text-primary);
            letter-spacing: -0.5px;
        }

        .summary-modal-close {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: none;
            background: var(--bg-light);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .summary-modal-close:hover {
            background: var(--error-light);
            color: var(--error);
        }

        .summary-modal-body {
            padding: 32px 40px;
        }

        .summary-section {
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .summary-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .summary-section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 13px;
        }

        .summary-item {
            display: flex;
            margin-bottom: 12px;
        }

        .summary-item-label {
            font-weight: 600;
            color: var(--text-secondary);
            min-width: 140px;
            font-size: 14px;
        }

        .summary-item-value {
            color: var(--text-primary);
            font-size: 14px;
            flex: 1;
        }

        .summary-modal-footer {
            padding: 24px 40px 32px;
            border-top: 1px solid var(--border-light);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Section Dividers */
        .section-divider {
            height: 1px;
            background: var(--border);
            margin: var(--space-3xl) 0;
            border: none;
        }

        /* Form Sections */
        .form-section {
            margin-bottom: var(--space-3xl);
            scroll-margin-top: 120px;
            padding: var(--space-xl) 0;
            position: relative;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.4s ease-out, transform 0.4s ease-out;
        }

        .form-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .form-section:last-of-type {
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--border);
            position: relative;
            transition: border-color 0.3s ease;
        }

        .form-section:hover .section-header {
            border-bottom-color: var(--primary);
        }

        .section-header::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 60px;
            height: 2px;
            background: var(--primary);
        }

        .section-number {
            background: var(--primary);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-size-base);
            flex-shrink: 0;
            letter-spacing: 0;
        }

        .section-title {
            color: var(--text-primary);
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-semibold);
            margin: 0;
            line-height: var(--line-height-tight);
            letter-spacing: -0.1px;
        }

        /* Form Grid */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-lg);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            margin-bottom: var(--space-lg);
            position: relative;
            transition: margin-bottom 0.2s ease;
        }

        .form-group:focus-within {
            margin-bottom: var(--space-xl);
        }

        .form-group:focus-within label {
            color: var(--primary);
            transition: color 0.2s ease;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            line-height: var(--line-height-normal);
        }

        .required {
            color: var(--error);
            font-weight: 700;
            margin-left: 2px;
        }

        .field-help-text {
            font-size: var(--font-size-sm);
            color: var(--text-primary);
            line-height: var(--line-height-relaxed);
            margin-bottom: var(--space-md);
            font-weight: var(--font-weight-normal);
        }

        .char-counter {
            font-size: var(--font-size-sm);
            color: var(--text-light);
            text-align: right;
            margin-top: var(--space-xs);
            font-weight: var(--font-weight-medium);
            transition: color 0.2s ease;
        }

        .char-counter.warning {
            color: var(--warning);
        }

        .char-counter.error {
            color: var(--error);
        }

        .message.info {
            background: #f0f9ff;
            border-color: var(--info);
            color: var(--info);
        }

        .spinner {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            margin-right: 8px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        input[type="number"],
        input[type="url"],
        select,
        textarea {
            width: 100%;
            padding: var(--space-md) var(--space-md);
            border: 1px solid var(--border);
            border-radius: 0;
            font-size: var(--font-size-base);
            font-family: inherit;
            transition: border-color 0.3s ease, box-shadow 0.3s ease, background-color 0.2s ease;
            background: var(--bg-white);
            color: var(--text-primary);
            font-weight: var(--font-weight-normal);
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus,
        input[type="date"]:focus,
        input[type="number"]:focus,
        input[type="url"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(10, 22, 41, 0.08);
            background: var(--bg-white);
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        input:hover:not(:disabled),
        select:hover:not(:disabled),
        textarea:hover:not(:disabled) {
            border-color: var(--primary-light);
            transition: border-color 0.2s ease;
        }

        input.error,
        select.error,
        textarea.error {
            border-color: var(--error);
        }

        input.error:focus,
        select.error:focus,
        textarea.error:focus {
            border-color: var(--error);
        }

        .error-message {
            font-size: var(--font-size-sm);
            color: var(--error);
            margin-top: var(--space-sm);
            display: none;
            font-weight: var(--font-weight-medium);
            line-height: var(--line-height-normal);
            padding: var(--space-sm) var(--space-md);
            background: #fff5f5;
            border-left: 3px solid var(--error);
            border-radius: 0;
        }

        .error-message.show {
            display: block;
        }

        textarea {
            resize: vertical;
            min-height: 130px;
            line-height: 1.7;
            padding-right: 50px; /* Space for voice button */
        }

        /* Voice-to-Text Button */
        .voice-input-wrapper {
            position: relative;
        }

        .voice-btn {
            position: absolute;
            right: 12px;
            top: 12px;
            width: 32px;
            height: 32px;
            border: 1px solid var(--border);
            background: var(--bg-white);
            border-radius: 2px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            z-index: 10;
            color: var(--text-muted);
            padding: 0;
        }
        
        .voice-btn::before {
            content: '';
            width: 14px;
            height: 14px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z'/%3E%3Cpath d='M19 10v2a7 7 0 0 1-14 0v-2'/%3E%3Cline x1='12' y1='19' x2='12' y2='23'/%3E%3Cline x1='8' y1='23' x2='16' y2='23'/%3E%3C/svg%3E");
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            display: block;
        }

        .voice-btn:hover {
            background: var(--bg-light);
            border-color: var(--primary);
        }
        
        .voice-btn:hover::before {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%230a1629' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z'/%3E%3Cpath d='M19 10v2a7 7 0 0 1-14 0v-2'/%3E%3Cline x1='12' y1='19' x2='12' y2='23'/%3E%3Cline x1='8' y1='23' x2='16' y2='23'/%3E%3C/svg%3E");
        }

        .voice-btn.recording {
            background: #fff5f5;
            border-color: var(--error);
        }
        
        .voice-btn.recording::before {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23dc2626' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z'/%3E%3Cpath d='M19 10v2a7 7 0 0 1-14 0v-2'/%3E%3Cline x1='12' y1='19' x2='12' y2='23'/%3E%3Cline x1='8' y1='23' x2='16' y2='23'/%3E%3C/svg%3E");
        }

        @keyframes pulse-recording {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes pulse-ring {
            0% {
                transform: scale(1);
                opacity: 0.3;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        .voice-status {
            position: absolute;
            right: 12px;
            top: -28px;
            font-size: 12px;
            color: var(--text-secondary);
            display: none;
            background: var(--bg-white);
            padding: 4px 8px;
            border: 1px solid var(--border);
            border-radius: 4px;
        }

        .voice-status.show {
            display: block;
        }

        .voice-status.recording {
            color: var(--error);
            border-color: var(--error);
        }

        /* File Upload */
        .file-upload-wrapper {
            position: relative;
        }

        .file-upload {
            position: relative;
            display: block;
            width: 100%;
        }

        .file-upload input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            z-index: 2;
        }

        .file-upload-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 32px 24px;
            border: 1px dashed var(--border);
            border-radius: 0;
            background: var(--bg-white);
            cursor: pointer;
            transition: border-color 0.2s ease;
            text-align: center;
        }

        .file-upload-label:hover {
            border-color: var(--primary);
            border-style: solid;
        }

        .file-upload-text {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .file-upload-hint {
            font-size: 12px;
            color: var(--text-light);
            line-height: 1.5;
        }

        .file-selected {
            padding: 12px 16px;
            background: #f8f9fa;
            border: 1px solid var(--border);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 12px;
        }

        .file-selected-name {
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-selected-name::before {
            content: '';
            background: var(--success);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }

        .file-selected-remove {
            background: none;
            border: none;
            color: var(--error);
            cursor: pointer;
            font-size: 20px;
            padding: 0;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .file-selected-remove:hover {
            background: rgba(239, 68, 68, 0.1);
        }

        .portfolio-files {
            margin-top: 12px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .portfolio-file-item {
            padding: 10px 14px;
            background: #f8f9fa;
            border: 1px solid var(--border);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 14px;
        }

        .portfolio-file-name {
            color: var(--text-primary);
            font-weight: 500;
        }

        .portfolio-file-remove {
            background: none;
            border: none;
            color: var(--error);
            cursor: pointer;
            font-size: 18px;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .portfolio-file-remove:hover {
            background: rgba(239, 68, 68, 0.1);
        }

        /* File Preview Styles */
        .file-preview-container {
            margin-top: 16px;
            display: none;
        }

        .file-preview-container.active {
            display: block;
        }

        .file-preview {
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }

        .file-preview:hover {
            box-shadow: var(--shadow-md);
        }

        .file-preview-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-light);
        }

        .file-preview-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .file-preview-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .file-preview-icon.pdf {
            background: #fee2e2;
            color: #dc2626;
        }

        .file-preview-icon.doc {
            background: #dbeafe;
            color: #2563eb;
        }

        .file-preview-icon.image {
            background: #f0fdf4;
            color: #16a34a;
        }

        .file-preview-icon.video {
            background: #fef3c7;
            color: #d97706;
        }

        .file-preview-icon.zip {
            background: #f3e8ff;
            color: #9333ea;
        }

        .file-preview-details {
            flex: 1;
            min-width: 0;
        }

        .file-preview-name {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
            margin-bottom: 4px;
            word-break: break-word;
        }

        .file-preview-size {
            font-size: 12px;
            color: var(--text-light);
        }

        .file-preview-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .file-preview-btn {
            padding: 6px 12px;
            border: 1px solid var(--border);
            background: var(--bg-white);
            color: var(--text-secondary);
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .file-preview-btn:hover {
            background: var(--bg-light);
            border-color: var(--primary);
            color: var(--primary);
        }

        .file-preview-content {
            margin-top: 12px;
        }

        .file-preview-image {
            width: 100%;
            max-height: 300px;
            object-fit: contain;
            border-radius: 8px;
            border: 1px solid var(--border-light);
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .file-preview-image:hover {
            transform: scale(1.02);
        }

        .file-preview-video {
            width: 100%;
            max-height: 300px;
            border-radius: 8px;
            border: 1px solid var(--border-light);
        }

        .file-preview-pdf {
            width: 100%;
            height: 400px;
            border: 1px solid var(--border-light);
            border-radius: 8px;
        }

        .file-preview-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            background: var(--bg-light);
            border-radius: 8px;
            border: 2px dashed var(--border);
            color: var(--text-light);
            font-size: 14px;
            text-align: center;
        }

        /* Portfolio File Preview Grid */
        .portfolio-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .portfolio-preview-item {
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .portfolio-preview-item:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .portfolio-preview-thumbnail {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: var(--bg-light);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .portfolio-preview-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .portfolio-preview-thumbnail .file-icon-large {
            font-size: 48px;
        }

        .portfolio-preview-footer {
            padding: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .portfolio-preview-name {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            flex: 1;
            min-width: 0;
            word-break: break-word;
            margin-right: 8px;
        }

        .portfolio-preview-remove {
            background: none;
            border: none;
            color: var(--error);
            cursor: pointer;
            font-size: 18px;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .portfolio-preview-remove:hover {
            background: rgba(239, 68, 68, 0.1);
        }

        /* Preview Modal */
        .preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(4px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .preview-modal.active {
            display: flex;
        }

        .preview-modal-content {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            background: var(--bg-white);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 24px 80px rgba(0, 0, 0, 0.5);
        }

        .preview-modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            transition: all 0.2s ease;
        }

        .preview-modal-close:hover {
            background: rgba(0, 0, 0, 0.8);
            transform: scale(1.1);
        }

        .preview-modal-body {
            max-height: 90vh;
            overflow: auto;
        }

        .preview-modal-body img,
        .preview-modal-body video {
            max-width: 100%;
            height: auto;
            display: block;
        }

        .preview-modal-body iframe {
            width: 100%;
            height: 90vh;
            border: none;
        }

        .video-instructions {
            background: #f8f9fa;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .video-instructions h4 {
            font-size: 15px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 12px;
        }

        .video-instructions ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .video-instructions li {
            padding: 6px 0 6px 20px;
            position: relative;
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 14px;
        }

        .video-instructions li::before {
            content: '';
            position: absolute;
            left: 8px;
            color: var(--primary);
            font-weight: 700;
        }

        .video-instructions strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        /* Permission Prompt */
        .permission-prompt {
            background: var(--bg-light);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 32px;
            text-align: center;
            margin-bottom: 20px;
        }

        .permission-prompt-content h4 {
            color: var(--primary);
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .permission-prompt-content p {
            color: var(--text-secondary);
            font-size: 15px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .permission-steps {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .permission-step {
            padding: 10px 0;
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
        }

        .permission-step strong {
            color: var(--primary);
            margin-right: 8px;
        }

        /* Video Recording Container */
        .video-recording-container {
            margin-top: 20px;
        }

        .video-recording-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 24px;
        }

        .video-option-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 16px 24px;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--bg-white);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            font-family: inherit;
        }

        .video-option-btn:hover {
            border-color: var(--primary);
            background: rgba(26, 61, 92, 0.03);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .video-option-btn.active {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        .video-option-icon {
            font-size: 18px;
            font-weight: 700;
            line-height: 1;
        }

        .video-option-text {
            font-weight: 600;
        }

        /* Video Preview Container */
        .video-preview-container {
            margin-top: 20px;
            animation: fadeIn 0.3s ease;
        }

        .video-preview-wrapper {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto 24px;
            border-radius: 12px;
            overflow: hidden;
            background: #000;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }

        .video-preview {
            width: 100%;
            display: block;
            border-radius: 12px;
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            z-index: 10;
        }

        .video-loading {
            text-align: center;
            color: white;
        }

        .video-loading p {
            margin-top: 16px;
            font-size: 15px;
            font-weight: 500;
        }

        .spinner-large {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto;
        }

        /* Recording Controls */
        .recording-controls {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .recording-controls-primary {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .recording-controls-secondary {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-record {
            min-width: 180px;
            padding: var(--space-sm) var(--space-lg);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            border-radius: 4px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-record:hover {
            opacity: 0.9;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            background: var(--primary-light);
        }

        .btn-danger {
            background: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background: #aa0000;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #005500;
        }

        .btn-secondary {
            background: var(--bg-white);
            color: var(--text-primary);
            border: 1px solid var(--border);
            padding: var(--space-sm) var(--space-lg);
            border-radius: 4px;
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .btn-secondary:hover {
            background: var(--bg-light);
            border-color: var(--primary);
        }


        .recording-timer-wrapper {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            background: #fff5f5;
            border-radius: 0;
            border: 1px solid var(--error);
        }

        .recording-indicator {
            width: 10px;
            height: 10px;
            background: #dc2626;
            border-radius: 50%;
        }

        .recording-timer {
            font-size: 18px;
            font-weight: 700;
            color: #dc2626;
            font-variant-numeric: tabular-nums;
            letter-spacing: 1px;
        }

        .recording-status {
            padding: 14px 20px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
            margin-top: 16px;
            animation: fadeIn 0.3s ease;
        }

        .recording-status.recording {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }

        .recording-status.stopped {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }

        .recording-status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }

        .video-instructions > div {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 16px;
        }

        .video-instructions > div > div ul {
            margin-top: 8px;
        }

        .video-instructions > div > div ul li {
            padding: 4px 0 4px 20px;
            font-size: 13px;
        }

        /* Fit Assessment - Radio Cards */
        .fit-question {
            margin-bottom: 24px;
        }

        .fit-question-label {
            display: block;
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .radio-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .radio-card {
            position: relative;
            cursor: pointer;
            display: block;
            border: 1px solid var(--border);
            border-radius: 0;
            padding: 0;
            transition: border-color 0.2s ease;
            background: var(--bg-white);
        }

        .radio-card:hover {
            border-color: var(--primary);
        }

        .radio-card input[type="radio"]:checked ~ .radio-card-content {
            color: var(--primary);
        }

        .radio-card:has(input[type="radio"]:checked) {
            border-color: var(--primary);
            border-width: 2px;
        }

        .radio-card input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .radio-card-content {
            padding: 20px;
            border: none;
            border-radius: 0;
            background: var(--bg-white);
            transition: background 0.2s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .radio-card:hover .radio-card-content {
            background: var(--bg-light);
        }

        .radio-card input[type="radio"]:checked + .radio-card-content {
            background: var(--bg-light);
        }

        .radio-card input[type="radio"]:checked + .radio-card-content::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 4px;
            height: 100%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 700;
            box-shadow: var(--shadow-sm);
        }

        .radio-card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .radio-card-desc {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Checkbox Group */
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 14px 16px;
            border: 1px solid var(--border);
            border-radius: 0;
            cursor: pointer;
            transition: border-color 0.2s ease, background 0.2s ease;
            background: var(--bg-white);
        }

        .checkbox-item:hover {
            border-color: var(--primary);
            background: var(--bg-light);
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .checkbox-item input[type="checkbox"]:checked + span {
            font-weight: 600;
            color: var(--primary);
        }

        .checkbox-item:has(input[type="checkbox"]:checked) {
            border-color: var(--primary);
            border-width: 2px;
            background: var(--bg-light);
        }

        /* Submit Section */
        .submit-section {
            margin-top: var(--space-5xl);
            padding-top: var(--space-3xl);
            border-top: 2px solid var(--border-light);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-md);
        }

        .submit-section-note {
            font-size: var(--font-size-sm);
            color: var(--text-primary);
            text-align: center;
            max-width: 650px;
            line-height: var(--line-height-loose);
            font-weight: var(--font-weight-normal);
        }

        .submit-btn {
            background: var(--primary);
            color: white;
            padding: var(--space-md) var(--space-2xl);
            border: none;
            border-radius: 0;
            font-size: var(--font-size-md);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            min-width: 220px;
            transition: background 0.3s ease;
            display: inline-block;
        }

        .submit-btn:hover:not(:disabled) {
            background: var(--primary-light);
        }

        .submit-btn:active:not(:disabled) {
            background: var(--primary-dark);
        }

        .submit-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
        }

        .submit-btn.loading {
            color: transparent;
        }

        .submit-btn.loading::after {
            content: '';
            position: absolute;
            width: 22px;
            height: 22px;
            top: 50%;
            left: 50%;
            margin-left: -11px;
            margin-top: -11px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }


        /* Messages */
        .message {
            padding: var(--space-md) var(--space-lg);
            border-radius: 0;
            margin-bottom: var(--space-xl);
            display: none;
            font-size: var(--font-size-base);
            line-height: var(--line-height-loose);
            font-weight: var(--font-weight-normal);
            border: 1px solid;
            position: relative;
        }

        .message::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: currentColor;
        }

        .message.success {
            background: #f0fff4;
            border-color: var(--success);
            color: var(--success);
        }

        .message.error {
            background: #fff5f5;
            border-color: var(--error);
            color: var(--error);
        }

        .message.info {
            background: #f0f9ff;
            border-color: var(--info);
            color: var(--info);
        }

        /* Auto-save indicator */
        .save-indicator {
            position: fixed;
            bottom: var(--space-lg);
            right: var(--space-lg);
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: 0;
            padding: var(--space-sm) var(--space-md);
            box-shadow: var(--shadow);
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
            display: none;
            z-index: 1000;
            font-weight: var(--font-weight-normal);
        }

        /* Start Application Button */
        .start-application-btn {
            display: block;
            position: sticky;
            top: 0;
            z-index: 100;
            background: var(--primary);
            color: white;
            border: none;
            padding: var(--space-md) var(--space-lg);
            border-radius: 0;
            font-size: var(--font-size-md);
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            width: 100%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: background 0.3s ease;
        }

        .start-application-btn:hover {
            background: var(--primary-light);
        }

        .start-application-btn:active {
            background: var(--primary-dark);
        }

        .job-description-toggle {
            display: block;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 0;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            margin-bottom: 16px;
            transition: background 0.2s ease;
        }

        .job-description-toggle:hover {
            background: var(--primary-light);
        }

        .job-description-toggle::after {
            content: ' ';
            font-size: 12px;
            margin-left: 8px;
            transition: transform 0.3s ease;
        }

        .job-description-toggle.collapsed::after {
            transform: rotate(-90deg);
        }

        .job-description-content {
            transition: all 0.3s ease;
        }

        .job-description-content.collapsed {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
        }

        .save-indicator.show {
            display: block;
            animation: slideUp 0.3s ease;
        }

        .save-indicator.saving {
            color: var(--primary);
        }

        .save-indicator.saved {
            color: var(--success);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Footer */
        .footer {
            text-align: left;
            padding: 56px 40px;
            color: var(--text-primary);
            font-size: 13px;
            background: var(--bg-white);
            border-top: 1px solid var(--border);
            margin-top: 80px;
            line-height: 1.7;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-section {
            margin-bottom: 24px;
        }

        .footer-section:last-child {
            margin-bottom: 0;
        }

        .footer h4 {
            color: var(--primary);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .footer p {
            color: var(--text-primary);
            font-size: 13px;
            line-height: 1.7;
            margin-bottom: 10px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 24px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .footer-links a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease;
        }

        .footer-links a:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }

        .footer strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .disclaimer-box {
            background: var(--bg-light);
            border: 1px solid var(--border);
            border-radius: 0;
            padding: 24px;
            margin-top: 32px;
            font-size: 12px;
            color: var(--text-primary);
            line-height: 1.7;
        }

        .disclaimer-box strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .content-layout {
                grid-template-columns: 1fr;
            }

            .nav-sidebar {
                position: relative;
                top: 0;
            }

            .main-container {
                padding: 0 30px;
            }

            .form-content {
                padding: 40px 45px;
            }

            .job-description {
                padding: 24px 30px;
            }

            .radio-cards {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            /* Mobile-first optimizations */
            body {
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .application-wrapper {
                overflow-x: hidden;
            }
            .start-application-btn {
                display: block;
                position: sticky;
                top: 0;
                z-index: 99;
                background: var(--primary);
                color: white;
                border: none;
                padding: 18px 20px;
                border-radius: 0;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                width: 100%;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                text-transform: uppercase;
                letter-spacing: 0.5px;
                transition: all 0.3s ease;
                -webkit-tap-highlight-color: transparent;
            }

            .start-application-btn:active {
                transform: scale(0.98);
                background: var(--primary-dark);
            }

            .position-card {
                margin-bottom: 16px;
                border-radius: 12px;
                overflow: hidden;
            }

            .position-card-header {
                padding: 20px 16px;
            }

            .position-card-header h2 {
                font-size: 20px;
                line-height: 1.3;
                margin-bottom: 8px;
            }

            .position-card-header p {
                font-size: 14px;
                line-height: 1.5;
            }

            .job-description-toggle {
                display: block;
            }

            .job-description {
                padding: 0;
            }

            .job-description-content {
                padding: 0 16px 16px;
            }

            .job-section {
                margin-bottom: 20px;
            }

            .job-section h3 {
                font-size: 16px;
                margin-bottom: 12px;
                line-height: 1.4;
            }

            .job-section ul {
                padding-left: 20px;
            }

            .job-section li {
                font-size: 14px;
                margin-bottom: 10px;
                line-height: 1.6;
            }

            .job-note {
                padding: 16px;
                background: var(--bg-light);
                border-radius: 8px;
                margin-top: 16px;
            }

            .job-note p {
                font-size: 13px;
                line-height: 1.6;
            }

            .header {
                margin-bottom: 0;
            }

            .header-content {
                padding: 35px 20px 30px;
            }

            .header h1 {
                font-size: 28px;
                line-height: 1.2;
                margin-bottom: 8px;
            }

            .header p {
                font-size: 15px;
                line-height: 1.4;
            }

            .main-container {
                margin: 0 auto;
                padding: 0 12px;
                max-width: 100%;
            }

            .form-card {
                border-radius: 12px;
                margin: 15px 0;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            }

            .form-content {
                padding: 20px 16px;
            }

            .form-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .form-section {
                padding: 20px 0;
                margin-bottom: 24px;
            }

            .section-header {
                margin-bottom: 16px;
                padding-bottom: 10px;
                flex-wrap: wrap;
                gap: 10px;
            }

            .section-title {
                font-size: 17px;
                line-height: 1.3;
            }

            .section-number {
                width: 28px;
                height: 28px;
                font-size: 13px;
                flex-shrink: 0;
            }

            .position-card {
                margin-bottom: 20px;
            }

            .position-card-header {
                padding: 20px 18px;
            }

            .position-card-header h2 {
                font-size: 22px;
            }

            .position-card-header p {
                font-size: 14px;
            }

            .job-description {
                padding: 20px 18px;
            }

            .job-section {
                margin-bottom: 24px;
            }

            .job-section h3 {
                font-size: 17px;
                margin-bottom: 10px;
            }

            .job-section ul {
                padding-left: 20px;
            }

            .job-section li {
                font-size: 14px;
                margin-bottom: 8px;
            }

            .radio-cards {
                grid-template-columns: 1fr;
                gap: 14px;
            }

            .radio-card {
                padding: 18px 16px;
                min-height: 60px;
                border-radius: 10px;
                -webkit-tap-highlight-color: transparent;
                touch-action: manipulation;
            }

            .radio-card:active {
                transform: scale(0.98);
            }

            .radio-card-title {
                font-size: 15px;
                font-weight: 600;
                margin-bottom: 6px;
            }

            .radio-card-desc {
                font-size: 13px;
                line-height: 1.5;
            }

            input[type="text"],
            input[type="email"],
            input[type="tel"],
            input[type="date"],
            input[type="number"],
            select,
            textarea {
                padding: 16px 18px;
                font-size: 16px; /* Prevents zoom on iOS */
                border-radius: 10px;
                border-width: 2px;
                -webkit-appearance: none;
                appearance: none;
                width: 100%;
                box-sizing: border-box;
            }

            select {
                background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%231a3d5c' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
                background-repeat: no-repeat;
                background-position: right 16px center;
                background-size: 12px;
                padding-right: 40px;
            }

            textarea {
                min-height: 140px;
                resize: vertical;
            }

            label {
                font-size: 14px;
                margin-bottom: 10px;
                font-weight: 600;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .file-upload-wrapper {
                margin-bottom: 20px;
            }

            .file-upload-label {
                padding: 32px 20px;
                min-height: 120px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                cursor: pointer;
                -webkit-tap-highlight-color: transparent;
            }

            .file-upload-label:active {
                transform: scale(0.98);
                background: var(--bg-light);
            }

            .file-upload-text {
                font-size: 15px;
                font-weight: 600;
                margin-bottom: 8px;
            }

            .file-upload-hint {
                font-size: 13px;
                line-height: 1.5;
                text-align: center;
            }

            .btn {
                padding: 18px 24px;
                font-size: 16px;
                font-weight: 600;
                min-height: 52px; /* Better touch target */
                width: 100%;
                border-radius: 10px;
                -webkit-tap-highlight-color: transparent;
                touch-action: manipulation;
            }

            .btn:active {
                transform: scale(0.98);
            }

            .progress-container {
                position: sticky;
                top: 0;
                z-index: 100;
                background: white;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
                margin-bottom: 0;
            }

            .progress-info {
                padding: 10px 16px;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                gap: 12px;
            }

            .progress-text {
                font-size: 12px;
                font-weight: 600;
            }

            .progress-percentage {
                font-size: 16px;
                font-weight: 700;
            }

            .progress-bar {
                height: 4px;
            }

            .nav-sidebar {
                position: relative;
                top: 0;
                margin-bottom: 20px;
                padding: 0;
                border-radius: 12px;
                background: var(--bg-white);
                border: 2px solid var(--border-light);
                box-shadow: var(--shadow-sm);
                overflow: hidden;
            }

            .nav-sidebar-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 16px 18px;
                background: var(--bg-light);
                border-bottom: 2px solid var(--border-light);
                cursor: pointer;
                -webkit-tap-highlight-color: transparent;
                user-select: none;
            }

            .nav-sidebar-header:active {
                background: var(--border-light);
            }

            .nav-sidebar h3 {
                font-size: 14px;
                margin: 0;
                font-weight: 700;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                color: var(--primary);
            }

            .nav-toggle-icon {
                font-size: 18px;
                color: var(--primary);
                transition: transform 0.3s ease;
                font-weight: 600;
            }

            .nav-sidebar.collapsed .nav-toggle-icon {
                transform: rotate(180deg);
            }

            .nav-sidebar-content {
                max-height: 400px;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
                transition: max-height 0.3s ease;
            }

            .nav-sidebar.collapsed .nav-sidebar-content {
                max-height: 0;
                overflow: hidden;
            }

            .nav-list {
                padding: 12px;
                margin: 0;
            }

            .nav-item {
                margin-bottom: 6px;
            }

            .nav-link {
                padding: 14px 16px;
                font-size: 14px;
                min-height: 48px;
                display: flex;
                align-items: center;
                -webkit-tap-highlight-color: transparent;
                border-radius: 8px;
                font-weight: 500;
            }

            .nav-link:active {
                background: var(--bg-light);
                transform: scale(0.98);
            }

            .nav-link.active {
                background: rgba(26, 61, 92, 0.1);
                color: var(--primary);
                font-weight: 600;
                border-left: 4px solid var(--primary);
            }

            .video-instructions {
                padding: 16px;
                border-radius: 10px;
                margin-bottom: 20px;
            }

            .video-instructions h4 {
                font-size: 16px;
                margin-bottom: 12px;
                line-height: 1.4;
            }

            .video-instructions > div {
                grid-template-columns: 1fr;
                gap: 14px;
            }

            .video-instructions ul {
                padding-left: 20px;
            }

            .video-instructions li {
                font-size: 13px;
                line-height: 1.6;
                margin-bottom: 8px;
            }

            .char-counter {
                font-size: 11px;
                margin-top: 6px;
            }

            .error-message {
                font-size: 12px;
                margin-top: 6px;
                padding: 8px 12px;
                border-radius: 6px;
            }

            .message {
                padding: 14px 16px;
                font-size: 14px;
                line-height: 1.5;
                margin-bottom: 20px;
                border-radius: 10px;
            }

            .file-selected {
                padding: 12px 16px;
                margin-top: 12px;
                border-radius: 8px;
                flex-wrap: wrap;
                gap: 10px;
            }

            .file-selected span {
                font-size: 13px;
            }

            .remove-file-btn {
                padding: 8px 14px;
                font-size: 13px;
                min-height: 36px;
                border-radius: 6px;
            }

            .footer {
                padding: 30px 20px;
                margin-top: 40px;
                text-align: center;
            }

            .footer h4 {
                font-size: 14px;
            }

            .footer p {
                font-size: 12px;
                line-height: 1.6;
            }

            .footer-links {
                gap: 16px;
                margin-top: 16px;
            }

            .disclaimer-box {
                padding: 16px;
                margin-top: 24px;
                font-size: 11px;
                line-height: 1.6;
            }

            .save-indicator {
                bottom: 20px;
                right: 20px;
                left: 20px;
                padding: 12px 16px;
                font-size: 13px;
                border-radius: 8px;
            }

            /* Additional mobile optimizations */
            .form-section:first-of-type {
                padding-top: 10px;
            }

            .section-divider {
                display: none;
            }

            /* Better spacing for file uploads */
            .file-upload-wrapper + .file-upload-wrapper {
                margin-top: 20px;
            }

            /* Optimize dropdowns on mobile */
            select {
                background-size: 14px;
                padding-right: 44px;
            }

            /* Better message display */
            .message {
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            /* Optimize character counters */
            .char-counter {
                position: relative;
                margin-top: 4px;
            }

            /* Better error display */
            .error-message {
                word-wrap: break-word;
                line-height: 1.4;
            }

            /* Optimize radio cards spacing */
            .fit-question {
                margin-bottom: 24px;
            }

            .fit-question-label {
                font-size: 14px;
                line-height: 1.5;
                margin-bottom: 14px;
            }

            /* Better video instructions */
            .video-instructions {
                margin-top: 20px;
            }

            /* Optimize document guidelines */
            .document-guidelines {
                padding: 16px;
                margin-bottom: 20px;
                border-radius: 10px;
            }

            .document-guidelines h4 {
                font-size: 15px;
                margin-bottom: 12px;
            }

            .document-guidelines ul {
                padding-left: 20px;
            }

            .document-guidelines li {
                font-size: 13px;
                line-height: 1.6;
                margin-bottom: 8px;
            }

            /* Better footer on mobile */
            .footer {
                padding: 24px 16px;
            }

            /* Hide desktop-only elements */
            .nav-link::before {
                display: none;
            }

            .nav-link:hover {
                padding-left: 16px;
            }
        }

        @media (max-width: 480px) {
            .header-content {
                padding: 40px 15px 30px;
            }

            .header h1 {
                font-size: 26px;
                line-height: 1.2;
            }

            .header p {
                font-size: 15px;
            }

            .main-container {
                margin: -25px auto 25px;
                padding: 0 12px;
            }

            .form-content {
                padding: 20px 15px;
            }

            .form-section {
                padding: 20px 0;
                margin-bottom: 25px;
            }

            .section-header {
                margin-bottom: 18px;
                padding-bottom: 10px;
            }

            .section-title {
                font-size: 17px;
            }

            .section-number {
                width: 30px;
                height: 30px;
                font-size: 13px;
            }

            .position-card-header {
                padding: 18px 15px;
            }

            .position-card-header h2 {
                font-size: 20px;
            }

            .job-description {
                padding: 18px 15px;
            }

            .job-section h3 {
                font-size: 16px;
            }

            .job-section li {
                font-size: 13px;
            }

            input[type="text"],
            input[type="email"],
            input[type="tel"],
            input[type="date"],
            input[type="number"],
            select,
            textarea {
                padding: 12px 14px;
                font-size: 16px; /* Prevents zoom on iOS */
            }

            .radio-card {
                padding: 12px;
            }

            .file-upload-label {
                padding: 25px 15px;
            }

            .btn {
                width: 100%;
                padding: 16px;
                font-size: 16px;
            }

            .progress-info {
                padding: 10px 12px;
            }

            .nav-sidebar {
                padding: 15px;
            }

            .video-instructions {
                padding: 15px;
            }

            .save-indicator {
                bottom: 16px;
                right: 16px;
                left: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="application-wrapper">
        <!-- Portal Top Bar -->
        <div class="portal-topbar">
            <div class="portal-topbar-content">
                <div class="portal-brand">
                    <div class="portal-brand-text">
                        <div class="portal-brand-name">Application Portal</div>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 20px;">
                    <div class="security-indicator">SSL Secured</div>
                    <div class="progress-percentage" id="progressPercentage" style="font-size: 14px; font-weight: 600; color: var(--text-primary); letter-spacing: 0.3px;">0% Complete</div>
                </div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <div class="header">
            <div class="header-content">
                <h1>Director - Marketing & Operations</h1>
                <p>Application Portal</p>
            </div>
        </div>

        <div class="main-container">
            <div class="position-card">
                <div class="position-card-header">
                    <h2>About Our Company</h2>
                    <p style="line-height: 1.85; margin-bottom: 24px; font-size: 16px; color: var(--text-secondary);">We are a leading U.S.-based commercial real estate brokerage specializing in the acquisition, disposition, and leasing of commercial properties. We facilitate complex transactions for institutional investors, Fortune 500 corporations, and property owners across warehouses, distribution centers, manufacturing facilities, and logistics hubs throughout the United States.</p>
                    <p style="line-height: 1.85; margin-bottom: 24px; font-size: 16px; color: var(--text-secondary);">Our firm operates at the intersection of sophisticated deal-making and operational excellence. We maintain the highest standards of professionalism, precision, and client service, managing every aspect of transactions from initial contract execution through closing. Our team's expertise in navigating complex real estate transactions has established us as a trusted partner to institutional clients who demand exceptional results.</p>
                    <p style="line-height: 1.85; margin-bottom: 24px; font-size: 16px; color: var(--text-secondary);"><strong>Our People Are Our Most Valuable Asset</strong></p>
                    <p style="line-height: 1.85; margin-bottom: 24px; font-size: 16px; color: var(--text-secondary);">We encourage independent thinking and reward initiative, while providing new skills, training, and mentoring to help our people grow professionally. Our business platform and reputation provide a strong foundation for your career development. We seek to attract and retain talented individuals across a wide spectrum of backgrounds and experiences, believing that diverse teams make better business decisions.</p>
                    <p style="line-height: 1.85; margin-bottom: 24px; font-size: 16px; color: var(--text-secondary);"><strong>Training & Development</strong></p>
                    <p style="line-height: 1.85; margin-bottom: 24px; font-size: 16px; color: var(--text-secondary);">We are committed to offering learning and development opportunities to help advance careers across a number of areas: marketing and design skills, real estate operations, leadership and management, communication, and technology. We provide structured training, ongoing mentoring, and opportunities to work on high-impact projects that build expertise and professional capabilities.</p>
                    <p style="line-height: 1.85; margin-bottom: 24px; font-size: 16px; color: var(--text-secondary);">We are seeking professionals who are problem solvers, who believe challenges represent opportunities, and who are eager to grow. Together with our entrepreneurial spirit, your unique skills and background will contribute to a creative and dynamic environment. This role offers the opportunity to work directly with senior leadership on strategic initiatives that shape our firm's success.</p>
                    <h3 style="font-size: var(--font-size-base); font-weight: var(--font-weight-semibold); color: var(--text-primary); margin-top: var(--space-xl); margin-bottom: var(--space-md); text-transform: uppercase; letter-spacing: 0.5px; padding-bottom: var(--space-sm); border-bottom: 2px solid var(--primary); display: inline-block;">Diversity, Equity & Inclusion</h3>
                    <p style="line-height: 1.85; font-size: 16px; color: var(--text-secondary);">We are committed to fostering a diverse, equitable, and inclusive workplace. We believe that diversity of thought, background, and experience strengthens our team and enhances our ability to serve our clients effectively. We are dedicated to creating an environment where all individuals feel valued, respected, and empowered to contribute their unique perspectives. Our commitment to diversity, equity, and inclusion is integral to our firm's values and our approach to building a high-performing team.</p>
                </div>
            </div>

            <div style="position: sticky; top: 0; z-index: 100; background: var(--bg-white); padding: 16px 0; margin: 24px 0; border-top: 1px solid var(--border); border-bottom: 1px solid var(--border);">
                <button class="start-application-btn" onclick="document.getElementById('section-1').scrollIntoView({behavior: 'smooth', block: 'start'});" style="display: block; width: 100%; margin: 0;">Start Application </button>
            </div>

            <div class="position-card" style="margin-top: 30px;">
                <div class="position-card-header">
                    <h2>Position: Director - Marketing & Operations</h2>
                    <p>Full-time remote role supporting commercial real estate brokerage operations</p>
                    
                    <div class="position-details">
                        
                        <div class="position-detail-section">
                            <h3>Compensation & Benefits</h3>
                            <ul>
                                <li>Starting compensation: $6-7 per hour (USD) based on experience, with opportunities for increases and performance-based bonuses</li>
                                <li>All required tools and software will be provided or expenses will be reimbursed</li>
                                <li>All U.S. federal holidays are observed with pay</li>
                            </ul>
                        </div>

                        <div class="position-detail-section">
                            <h3>Position Overview</h3>
                            <p>This is a full-time, director-level position requiring a minimum of 40 hours per week during standard U.S. business hours. This is a direct hire position with no intermediaries, agencies, or third-party recruiters involved in the hiring process.</p>
                            <p>The successful candidate will work directly with senior leadership, including the CEO and Senior Brokers, on strategic initiatives that support the firm's operations. Responsibilities include supporting institutional client relationships and managing high-value transaction coordination. Regular participation in company and team meetings is required as this is an integral team position.</p>
                        </div>

                        <div class="position-detail-section">
                            <h3>Company Overview</h3>
                            <p>Our firm is experiencing rapid growth and maintains a culture focused on excellence, collaboration, and professional development. We recognize and reward high performance and are committed to providing a professional work environment where exceptional talent can thrive. We seek long-term team members who will grow with the organization as we continue to expand.</p>
                        </div>

                        <div class="position-detail-section">
                            <h3>Professional Development & Training</h3>
                            <p>The firm offers professional development opportunities and paid training programs. Approved courses, certifications, and educational programs that enhance job-related skills and advance professional development will be supported. The firm is committed to investing in team member growth and professional development.</p>
                        </div>

                        <div class="position-detail-section">
                            <h3>Interview Process</h3>
                            <p>The interview process is designed to ensure mutual fit between the candidate and the organization. Selected candidates will advance through a structured interview process that respects candidate time while ensuring appropriate evaluation for both parties.</p>
                        </div>

                    </div>
                </div>
                <div class="job-description" style="margin-top: 24px;">
                    <div class="job-description-content" style="max-height: none; opacity: 1; overflow: visible;">
                    <div class="job-section">
                        <h3>Key Responsibilities</h3>
                        <ul>
                            <li><strong>Marketing & Design (Primary):</strong> Create professional marketing materials, presentations, and graphics using Canva, Adobe InDesign, Illustrator, or similar</li>
                            <li><strong>Operations:</strong> Coordinate transactions from contract to closing, manage documentation and timelines</li>
                            <li><strong>CRM & Communication:</strong> Maintain databases, communicate with clients, brokers, attorneys, lenders, and title companies</li>
                            <li><strong>Process Improvement:</strong> Develop and improve internal systems, workflows, and operational processes</li>
                        </ul>
                    </div>
                    <div class="job-section">
                        <h3>Qualifications</h3>
                        <ul>
                            <li><strong>Education:</strong> Bachelor's degree or equivalent, or compelling work experience (not entry-level)</li>
                            <li><strong>Marketing & Design:</strong> Strong portfolio and experience with design platforms (Canva, Adobe InDesign, Illustrator, Photoshop)</li>
                            <li><strong>Experience:</strong> 35 years in real estate operations, transaction coordination, marketing, or related role (preferred but not required)</li>
                            <li><strong>Skills:</strong> Excellent English communication, strong organizational skills, Microsoft Office proficiency, CRM experience (preferred)</li>
                            <li><strong>Requirements:</strong> Reliable high-speed internet connection (minimum 10 Mbps download/upload for Teams calls and video conferencing), professional home office environment, availability during U.S. business hours</li>
                        </ul>
                    </div>
                    <div class="job-note">
                        <p><strong>Note:</strong> <strong>Marketing and design skills are our top priority.</strong> If you don't have direct real estate experience, we encourage you to apply! We're looking for candidates with strong marketing, design, and creative skills who can learn the real estate operations aspect.</p>
                    </div>
                    </div>
                </div>
            </div>

            <div class="content-layout">
                <!-- Navigation Sidebar -->
                <nav class="nav-sidebar" id="navSidebar">
                    <div class="nav-sidebar-header" onclick="toggleNavSidebar()">
                        <h3>Application Sections</h3>
                        <span class="nav-toggle-icon"></span>
                    </div>
                    <div class="nav-sidebar-content">
                        <ul class="nav-list" id="navList"></ul>
                    </div>
                </nav>

                <!-- Form Card -->
                <div class="form-card">
                    <div class="form-content">
                        <noscript>
                            <div class="message error" style="display: block;">
                                <strong>JavaScript is required</strong> for this application portal to work properly.
                            </div>
                        </noscript>

                            <div class="portal-welcome">
                                <h2>Application Portal</h2>
                                <p>Thank you for your interest in the Director - Marketing & Operations position. We appreciate the time you're investing in this application. This secure portal has been designed to provide you with a comprehensive understanding of the role while allowing us to learn about your qualifications, experience, and professional goals. Please complete all required sections thoughtfullywe review each application carefully and look forward to learning how your expertise aligns with our needs.</p>
                                
                                <div class="form-completion-notice">
                                    <p><strong>Form Completion:</strong> Fields marked with a red asterisk (*) must be completed to be considered for this position. Failure to provide required information may compromise the follow-up of your application. When you have finished completing all sections, click "Submit Application" at the bottom of this form.</p>
                                </div>
                                
                                <div id="lastSaveInfo" class="last-save-info"></div>
                                
                                <div class="portal-welcome-features">
                                <div class="portal-feature">
                                    <div class="portal-feature-content">
                                        <h4>Secure Transmission</h4>
                                        <p>All data is transmitted over encrypted SSL/TLS connections and stored securely using industry-standard security protocols.</p>
                                    </div>
                                </div>
                                <div class="portal-feature">
                                    <div class="portal-feature-content">
                                        <h4>Auto-Save</h4>
                                        <p>Your progress is automatically saved to your browser. You can return to continue your application at any time (files must be re-uploaded).</p>
                                    </div>
                                </div>
                                <div class="portal-feature">
                                    <div class="portal-feature-content">
                                        <h4>Confidential Review</h4>
                                        <p>All applications are reviewed by authorized personnel only. Your information is maintained in strict confidence and used solely for recruitment purposes.</p>
                                    </div>
                                </div>
                                <div class="portal-feature">
                                    <div class="portal-feature-content">
                                        <h4>Voice-to-Text Available</h4>
                                        <p>Use the microphone button next to any text field to speak your answers instead of typing. This feature works best in Chrome or Edge browsers.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="message" class="message"></div>

                        <form id="applicationForm" enctype="multipart/form-data">
                            <!-- Personal Information -->
                            <div class="form-section" id="section-1" data-section="1">
                                <div class="section-header">
                                    <div class="section-number">1</div>
                                    <h3 class="section-title">Personal Information</h3>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="fullName">
                                            Full Name <span class="required">*</span>
                                            <span class="help-tooltip">
                                                <span class="help-icon">?</span>
                                                <span class="help-tooltip-content">Please enter your legal first and last name as it appears on official documents</span>
                                            </span>
                                        </label>
                                        <input type="text" id="fullName" name="fullName" required>
                                        <div class="error-message" id="fullName-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="email">Email Address <span class="required">*</span></label>
                                        <input type="email" id="email" name="email" required>
                                        <div class="error-message" id="email-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="phone">Phone Number <span class="required">*</span></label>
                                        <div style="display: grid; grid-template-columns: 140px 1fr; gap: 12px;">
                                            <select id="countryCode" name="countryCode" required style="padding: 12px 14px; border: 1px solid var(--border); border-radius: 0; font-size: 15px; color: var(--text-primary); background: var(--bg-white);">
                                                <option value="">Code</option>
                                                <option value="+1">+1 (US/CA)</option>
                                                <option value="+63">+63 (PH)</option>
                                                <option value="+27">+27 (ZA)</option>
                                                <option value="+44">+44 (UK)</option>
                                                <option value="+61">+61 (AU)</option>
                                                <option value="+91">+91 (IN)</option>
                                                <option value="+52">+52 (MX)</option>
                                                <option value="+55">+55 (BR)</option>
                                                <option value="+86">+86 (CN)</option>
                                                <option value="+81">+81 (JP)</option>
                                                <option value="+65">+65 (SG)</option>
                                                <option value="+60">+60 (MY)</option>
                                                <option value="+62">+62 (ID)</option>
                                                <option value="+66">+66 (TH)</option>
                                                <option value="+84">+84 (VN)</option>
                                                <option value="+64">+64 (NZ)</option>
                                                <option value="+353">+353 (IE)</option>
                                                <option value="+31">+31 (NL)</option>
                                                <option value="+49">+49 (DE)</option>
                                                <option value="+33">+33 (FR)</option>
                                                <option value="+39">+39 (IT)</option>
                                                <option value="+34">+34 (ES)</option>
                                                <option value="+351">+351 (PT)</option>
                                                <option value="+32">+32 (BE)</option>
                                                <option value="+41">+41 (CH)</option>
                                                <option value="+45">+45 (DK)</option>
                                                <option value="+46">+46 (SE)</option>
                                                <option value="+47">+47 (NO)</option>
                                                <option value="+358">+358 (FI)</option>
                                                <option value="+48">+48 (PL)</option>
                                                <option value="+420">+420 (CZ)</option>
                                                <option value="+36">+36 (HU)</option>
                                                <option value="+40">+40 (RO)</option>
                                                <option value="+7">+7 (RU)</option>
                                                <option value="+971">+971 (AE)</option>
                                                <option value="+966">+966 (SA)</option>
                                                <option value="+972">+972 (IL)</option>
                                                <option value="+20">+20 (EG)</option>
                                                <option value="+234">+234 (NG)</option>
                                                <option value="+254">+254 (KE)</option>
                                                <option value="+233">+233 (GH)</option>
                                                <option value="+256">+256 (UG)</option>
                                                <option value="+250">+250 (RW)</option>
                                                <option value="+255">+255 (TZ)</option>
                                                <option value="+260">+260 (ZM)</option>
                                                <option value="+263">+263 (ZW)</option>
                                                <option value="+264">+264 (NA)</option>
                                                <option value="+267">+267 (BW)</option>
                                                <option value="+268">+268 (SZ)</option>
                                                <option value="+269">+269 (SC)</option>
                                                <option value="+230">+230 (MU)</option>
                                                <option value="+212">+212 (MA)</option>
                                                <option value="+213">+213 (DZ)</option>
                                                <option value="+216">+216 (TN)</option>
                                                <option value="+218">+218 (LY)</option>
                                                <option value="+220">+220 (GM)</option>
                                                <option value="+221">+221 (SN)</option>
                                                <option value="+223">+223 (ML)</option>
                                                <option value="+224">+224 (GN)</option>
                                                <option value="+225">+225 (CI)</option>
                                                <option value="+226">+226 (BF)</option>
                                                <option value="+227">+227 (NE)</option>
                                                <option value="+228">+228 (TG)</option>
                                                <option value="+229">+229 (BJ)</option>
                                                <option value="+235">+235 (TD)</option>
                                                <option value="+236">+236 (CF)</option>
                                                <option value="+237">+237 (CM)</option>
                                                <option value="+238">+238 (CV)</option>
                                                <option value="+239">+239 (ST)</option>
                                                <option value="+240">+240 (GQ)</option>
                                                <option value="+241">+241 (GA)</option>
                                                <option value="+242">+242 (CG)</option>
                                                <option value="+243">+243 (CD)</option>
                                                <option value="+244">+244 (AO)</option>
                                                <option value="+245">+245 (GW)</option>
                                                <option value="+246">+246 (IO)</option>
                                                <option value="+248">+248 (SC)</option>
                                                <option value="+249">+249 (SD)</option>
                                                <option value="+251">+251 (ET)</option>
                                                <option value="+252">+252 (SO)</option>
                                                <option value="+253">+253 (DJ)</option>
                                                <option value="+257">+257 (BI)</option>
                                                <option value="+258">+258 (MZ)</option>
                                                <option value="+261">+261 (MG)</option>
                                                <option value="+265">+265 (MW)</option>
                                                <option value="+266">+266 (LS)</option>
                                                <option value="+290">+290 (SH)</option>
                                                <option value="+291">+291 (ER)</option>
                                                <option value="+297">+297 (AW)</option>
                                                <option value="+298">+298 (FO)</option>
                                                <option value="+299">+299 (GL)</option>
                                                <option value="+350">+350 (GI)</option>
                                                <option value="+352">+352 (LU)</option>
                                                <option value="+354">+354 (IS)</option>
                                                <option value="+355">+355 (AL)</option>
                                                <option value="+356">+356 (MT)</option>
                                                <option value="+357">+357 (CY)</option>
                                                <option value="+359">+359 (BG)</option>
                                                <option value="+370">+370 (LT)</option>
                                                <option value="+371">+371 (LV)</option>
                                                <option value="+372">+372 (EE)</option>
                                                <option value="+373">+373 (MD)</option>
                                                <option value="+374">+374 (AM)</option>
                                                <option value="+375">+375 (BY)</option>
                                                <option value="+376">+376 (AD)</option>
                                                <option value="+377">+377 (MC)</option>
                                                <option value="+378">+378 (SM)</option>
                                                <option value="+380">+380 (UA)</option>
                                                <option value="+381">+381 (RS)</option>
                                                <option value="+382">+382 (ME)</option>
                                                <option value="+383">+383 (XK)</option>
                                                <option value="+385">+385 (HR)</option>
                                                <option value="+386">+386 (SI)</option>
                                                <option value="+387">+387 (BA)</option>
                                                <option value="+389">+389 (MK)</option>
                                                <option value="+390">+390 (VA)</option>
                                                <option value="+421">+421 (SK)</option>
                                                <option value="+423">+423 (LI)</option>
                                                <option value="+500">+500 (FK)</option>
                                                <option value="+501">+501 (BZ)</option>
                                                <option value="+502">+502 (GT)</option>
                                                <option value="+503">+503 (SV)</option>
                                                <option value="+504">+504 (HN)</option>
                                                <option value="+505">+505 (NI)</option>
                                                <option value="+506">+506 (CR)</option>
                                                <option value="+507">+507 (PA)</option>
                                                <option value="+508">+508 (PM)</option>
                                                <option value="+509">+509 (HT)</option>
                                                <option value="+590">+590 (BL)</option>
                                                <option value="+591">+591 (BO)</option>
                                                <option value="+592">+592 (GY)</option>
                                                <option value="+593">+593 (EC)</option>
                                                <option value="+594">+594 (GF)</option>
                                                <option value="+595">+595 (PY)</option>
                                                <option value="+596">+596 (MQ)</option>
                                                <option value="+597">+597 (SR)</option>
                                                <option value="+598">+598 (UY)</option>
                                                <option value="+599">+599 (CW)</option>
                                                <option value="+670">+670 (TL)</option>
                                                <option value="+672">+672 (NF)</option>
                                                <option value="+673">+673 (BN)</option>
                                                <option value="+674">+674 (NR)</option>
                                                <option value="+675">+675 (PG)</option>
                                                <option value="+676">+676 (TO)</option>
                                                <option value="+677">+677 (SB)</option>
                                                <option value="+678">+678 (VU)</option>
                                                <option value="+679">+679 (FJ)</option>
                                                <option value="+680">+680 (PW)</option>
                                                <option value="+681">+681 (WF)</option>
                                                <option value="+682">+682 (CK)</option>
                                                <option value="+683">+683 (NU)</option>
                                                <option value="+685">+685 (WS)</option>
                                                <option value="+686">+686 (KI)</option>
                                                <option value="+687">+687 (NC)</option>
                                                <option value="+688">+688 (TV)</option>
                                                <option value="+689">+689 (PF)</option>
                                                <option value="+850">+850 (KP)</option>
                                                <option value="+852">+852 (HK)</option>
                                                <option value="+853">+853 (MO)</option>
                                                <option value="+855">+855 (KH)</option>
                                                <option value="+856">+856 (LA)</option>
                                                <option value="+880">+880 (BD)</option>
                                                <option value="+886">+886 (TW)</option>
                                                <option value="+960">+960 (MV)</option>
                                                <option value="+961">+961 (LB)</option>
                                                <option value="+962">+962 (JO)</option>
                                                <option value="+963">+963 (SY)</option>
                                                <option value="+964">+964 (IQ)</option>
                                                <option value="+965">+965 (KW)</option>
                                                <option value="+967">+967 (YE)</option>
                                                <option value="+968">+968 (OM)</option>
                                                <option value="+970">+970 (PS)</option>
                                                <option value="+973">+973 (BH)</option>
                                                <option value="+974">+974 (QA)</option>
                                                <option value="+975">+975 (BT)</option>
                                                <option value="+976">+976 (MN)</option>
                                                <option value="+977">+977 (NP)</option>
                                                <option value="+992">+992 (TJ)</option>
                                                <option value="+993">+993 (TM)</option>
                                                <option value="+994">+994 (AZ)</option>
                                                <option value="+995">+995 (GE)</option>
                                                <option value="+996">+996 (KG)</option>
                                                <option value="+998">+998 (UZ)</option>
                                            </select>
                                            <input type="tel" id="phone" name="phone" placeholder="Phone number" required style="padding: 12px 14px; border: 1px solid var(--border); border-radius: 0; font-size: 15px;">
                                        </div>
                                        <div class="error-message" id="phone-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="location">Location (City, Country) <span class="required">*</span></label>
                                        <input type="text" id="location" name="location" required>
                                        <div class="error-message" id="location-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="linkedin">
                                            LinkedIn Profile (Optional)
                                            <span class="help-tooltip">
                                                <span class="help-icon">?</span>
                                                <span class="help-tooltip-content">Share your LinkedIn profile URL if you have one</span>
                                            </span>
                                        </label>
                                        <input type="url" id="linkedin" name="linkedin" placeholder="https://linkedin.com/in/yourprofile">
                                        <div class="error-message" id="linkedin-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="personalWebsite">Personal Website or Portfolio (Optional)</label>
                                        <input type="url" id="personalWebsite" name="personalWebsite" placeholder="https://yourwebsite.com or portfolio link">
                                        <div class="error-message" id="personalWebsite-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="preferredCommunication">Preferred Communication Method <span class="required">*</span></label>
                                        <select id="preferredCommunication" name="preferredCommunication" required>
                                            <option value="">Select...</option>
                                            <option value="email">Email</option>
                                            <option value="phone">Phone</option>
                                            <option value="text">Text Message</option>
                                            <option value="whatsapp">WhatsApp</option>
                                            <option value="other">Other</option>
                                        </select>
                                        <div class="error-message" id="preferredCommunication-error"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Education -->
                            <div class="form-section" id="section-2" data-section="2">
                                <div class="section-header">
                                    <div class="section-number">2</div>
                                    <h3 class="section-title">Education</h3>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="highestEducation">Highest Level of Education <span class="required">*</span></label>
                                        <select id="highestEducation" name="highestEducation" required>
                                            <option value="">Select...</option>
                                            <option value="high-school">High School Diploma</option>
                                            <option value="some-college">Some College</option>
                                            <option value="associates">Associate's Degree</option>
                                            <option value="bachelors">Bachelor's Degree</option>
                                            <option value="masters">Master's Degree</option>
                                            <option value="phd">PhD/Doctorate</option>
                                            <option value="other">Other</option>
                                        </select>
                                        <div class="error-message" id="highestEducation-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="educationField">Field of Study</label>
                                        <input type="text" id="educationField" name="educationField" placeholder="e.g., Business Administration, Real Estate, Communications">
                                    </div>
                                    <div class="form-group full-width">
                                        <label for="institution">Institution Name</label>
                                        <input type="text" id="institution" name="institution" placeholder="e.g., University Name">
                                    </div>
                                    <div class="form-group">
                                        <label for="graduationYear">Graduation Year</label>
                                        <input type="number" id="graduationYear" name="graduationYear" min="1950" max="2030" placeholder="e.g., 2020">
                                    </div>
                                    <div class="form-group">
                                        <label for="gpa">GPA (Optional)</label>
                                        <input type="text" id="gpa" name="gpa" placeholder="e.g., 3.5 or 3.5/4.0">
                                    </div>
                                    <div class="form-group full-width">
                                        <label for="additionalEducation">Additional Education, Certifications, or Training</label>
                                        <textarea id="additionalEducation" name="additionalEducation" placeholder="List any relevant certifications, professional development courses, or additional training (e.g., Real Estate License, Project Management Certification, etc.)" maxlength="1000"></textarea>
                                        <div class="char-counter" id="additionalEducation-counter">0 / 1000 characters</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Professional Experience -->
                            <div class="form-section" id="section-3" data-section="3">
                                <div class="section-header">
                                    <div class="section-number">3</div>
                                    <h3 class="section-title">Professional Experience</h3>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="marketingDesignExperience">Years of Marketing/Design Experience <span class="required">*</span></label>
                                        <select id="marketingDesignExperience" name="marketingDesignExperience" required>
                                            <option value="">Select...</option>
                                            <option value="0-1">Less than 1 year</option>
                                            <option value="1-2">1-2 years</option>
                                            <option value="3-5">3-5 years</option>
                                            <option value="5+">5+ years</option>
                                        </select>
                                        <div class="error-message" id="marketingDesignExperience-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="creExperience">Real Estate Experience <span class="required">*</span></label>
                                        <select id="creExperience" name="creExperience" required>
                                            <option value="">Select...</option>
                                            <option value="none">No real estate experience</option>
                                            <option value="1-2">1-2 years</option>
                                            <option value="3-5">3-5 years</option>
                                            <option value="5+">5+ years</option>
                                        </select>
                                        <div class="error-message" id="creExperience-error"></div>
                                    </div>
                                    <div class="form-group full-width">
                                        <label for="previousRole">Current/Previous Role/Position <span class="required">*</span></label>
                                        <input type="text" id="previousRole" name="previousRole" placeholder="e.g., Marketing Coordinator, Graphic Designer, Operations Manager, Transaction Coordinator" required>
                                        <div class="error-message" id="previousRole-error"></div>
                                    </div>
                                    <div class="form-group full-width">
                                        <label for="marketingExperience">Describe your marketing and design experience. What types of marketing materials, graphics, or presentations have you created? <span class="required">*</span></label>
                                        <textarea id="marketingExperience" name="marketingExperience" placeholder="Please describe your experience creating marketing materials such as pitch decks, PowerPoint presentations, organizational charts, social media advertising, LinkedIn posts, graphics, brochures, or other design work. Include details about the types of projects, tools you've used, and the impact of your work. If you have a portfolio, you'll be able to upload samples later in this application." required maxlength="2000"></textarea>
                                        <div class="char-counter" id="marketingExperience-counter">0 / 2000 characters</div>
                                        <div class="error-message" id="marketingExperience-error"></div>
                                    </div>
                                    <div class="form-group full-width" id="realEstateExperienceSection" style="display: none;">
                                        <label for="transactionExperience">If you have real estate experience, describe your experience coordinating transactions from contract to closing <span class="required">*</span></label>
                                        <textarea id="transactionExperience" name="transactionExperience" placeholder="Include details about managing timelines, due diligence, documentation, and stakeholder communication." maxlength="2000"></textarea>
                                        <div class="char-counter" id="transactionExperience-counter">0 / 2000 characters</div>
                                        <div class="error-message" id="transactionExperience-error"></div>
                                    </div>
                                    <div class="form-group full-width" id="transferableExperienceSection">
                                        <label for="transferableExperience">If you don't have real estate experience, describe relevant transferable experiences that demonstrate your ability to succeed in this role <span class="required">*</span></label>
                                        <textarea id="transferableExperience" name="transferableExperience" placeholder="Describe experiences from project coordination, operations management, marketing, administrative support, or similar roles. Focus on skills like managing deadlines, coordinating with multiple stakeholders, attention to detail, and creating professional deliverables." required maxlength="2000"></textarea>
                                        <div class="char-counter" id="transferableExperience-counter">0 / 2000 characters</div>
                                        <div class="error-message" id="transferableExperience-error"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Technical Skills -->
                            <div class="form-section" id="section-4" data-section="4">
                                <div class="section-header">
                                    <div class="section-number">4</div>
                                    <h3 class="section-title">Technical Skills & Software</h3>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="microsoftOffice">Microsoft Office Proficiency <span class="required">*</span></label>
                                        <select id="microsoftOffice" name="microsoftOffice" required>
                                            <option value="">Select...</option>
                                            <option value="expert">Expert (Advanced Excel, PowerPoint)</option>
                                            <option value="proficient">Proficient (Strong Excel, PowerPoint)</option>
                                            <option value="intermediate">Intermediate (Basic Excel, PowerPoint)</option>
                                            <option value="beginner">Beginner</option>
                                        </select>
                                        <div class="error-message" id="microsoftOffice-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="crmSystems">CRM Systems Experience <span class="required">*</span></label>
                                        <select id="crmSystems" name="crmSystems" required>
                                            <option value="">Select...</option>
                                            <option value="expert">Expert (Multiple systems, advanced features)</option>
                                            <option value="proficient">Proficient (Strong experience with 1-2 systems)</option>
                                            <option value="intermediate">Intermediate (Basic CRM experience)</option>
                                            <option value="beginner">Beginner</option>
                                        </select>
                                        <div class="error-message" id="crmSystems-error"></div>
                                    </div>
                                    <div class="form-group full-width">
                                        <label for="crmExperience">Which CRM systems have you used? Please describe your experience <span class="required">*</span></label>
                                        <textarea id="crmExperience" name="crmExperience" placeholder="e.g., Salesforce, HubSpot, Buildout, CoStar, or others. Describe your experience with database management, deal tracking, and reporting." required maxlength="1500"></textarea>
                                        <div class="char-counter" id="crmExperience-counter">0 / 1500 characters</div>
                                        <div class="error-message" id="crmExperience-error"></div>
                                    </div>
                                    <div class="form-group full-width">
                                        <label for="designTools">Design & Graphics Software Experience <span class="required">*</span></label>
                                        <div class="checkbox-group">
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="designTools" value="Canva">
                                                <span>Canva</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="designTools" value="Adobe InDesign">
                                                <span>Adobe InDesign</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="designTools" value="Adobe Illustrator">
                                                <span>Adobe Illustrator</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="designTools" value="Adobe Photoshop">
                                                <span>Adobe Photoshop</span>
                                            </label>
                                            <label class="checkbox-item">
                                                <input type="checkbox" name="designTools" value="Other">
                                                <span>Other Design Tools</span>
                                            </label>
                                        </div>
                                        <div class="error-message" id="designTools-error"></div>
                                    </div>
                                    <div class="form-group full-width">
                                        <label for="marketingMaterials">Describe your experience creating marketing materials (pitch decks, PowerPoint presentations, organizational charts, social media advertising, LinkedIn posts, offering memorandums, property listings, etc.) <span class="required">*</span></label>
                                        <textarea id="marketingMaterials" name="marketingMaterials" placeholder="Include examples of materials you've created such as pitch decks, PowerPoint presentations, organizational charts, social media content, LinkedIn posts, and your design process" required maxlength="2000"></textarea>
                                        <div class="char-counter" id="marketingMaterials-counter">0 / 2000 characters</div>
                                        <div class="error-message" id="marketingMaterials-error"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Availability & Work Schedule -->
                            <div class="form-section" id="section-5" data-section="5">
                                <div class="section-header">
                                    <div class="section-number">5</div>
                                    <h3 class="section-title">Availability & Work Schedule</h3>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="timezone">Your Timezone <span class="required">*</span></label>
                                        <input type="text" id="timezone" name="timezone" placeholder="e.g., EST, PST, GMT+5, IST" required>
                                        <div class="error-message" id="timezone-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="usHoursOverlap">Can you work US business hours? (e.g., 9:00 AM to 5:00 PM EST) <span class="required">*</span></label>
                                        <select id="usHoursOverlap" name="usHoursOverlap" required>
                                            <option value="">Select...</option>
                                            <option value="yes">Yes</option>
                                            <option value="no">No</option>
                                        </select>
                                        <div class="error-message" id="usHoursOverlap-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="startDate">Earliest Start Date <span class="required">*</span></label>
                                        <input type="date" id="startDate" name="startDate" required>
                                        <div class="error-message" id="startDate-error"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Role-Specific Questions -->
                            <div class="form-section" id="section-6" data-section="6">
                                <div class="section-header">
                                    <div class="section-number">6</div>
                                    <h3 class="section-title">Assessment</h3>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group full-width">
                                        <label for="transactionCoordination">Describe your experience managing complex transactions or projects, including documentation, timelines, due diligence, stakeholder coordination, and any experience improving systems and workflows (or relevant transferable experience) <span class="required">*</span></label>
                                        <textarea id="transactionCoordination" name="transactionCoordination" placeholder="If you have real estate experience, include details about managing transaction documentation, timelines, due diligence materials, and coordinating with multiple stakeholders. If not, describe similar complex projects you've managed. Also share examples of process improvements you've implemented or systems you've helped optimize, and your approach to maintaining accuracy and attention to detail. Include specific examples of challenges faced and outcomes achieved." required maxlength="3000"></textarea>
                                        <div class="char-counter" id="transactionCoordination-counter">0 / 3000 characters</div>
                                        <div class="error-message" id="transactionCoordination-error"></div>
                                    </div>

                                    <div class="form-group full-width">
                                        <label for="timeManagement">Describe how you handle challenges, manage multiple deadlines and competing priorities, and overcome difficult situations at work <span class="required">*</span></label>
                                        <textarea id="timeManagement" name="timeManagement" placeholder="Provide a specific example of a difficult project or challenging situation you overcame, including the situation, how you handled it, and the outcome. Also explain your approach to managing multiple projects, deadlines, and competing priorities, including any tools, methods, or strategies you use." required maxlength="2500"></textarea>
                                        <div class="char-counter" id="timeManagement-counter">0 / 2500 characters</div>
                                        <div class="error-message" id="timeManagement-error"></div>
                                    </div>

                                    <div class="form-group full-width">
                                        <label for="careerGoals">Why are you interested in this role, and how does it fit into your career goals over the next 2-3 years? <span class="required">*</span></label>
                                        <textarea id="careerGoals" name="careerGoals" placeholder="Describe what draws you to this position, how it aligns with your career goals, where you see yourself in 2-3 years, and how this role fits into your professional aspirations." required maxlength="2000"></textarea>
                                        <div class="char-counter" id="careerGoals-counter">0 / 2000 characters</div>
                                        <div class="error-message" id="careerGoals-error"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="managementExperience">Do you have experience managing people or managing teams? <span class="required">*</span></label>
                                        <select id="managementExperience" name="managementExperience" required>
                                            <option value="">Select...</option>
                                            <option value="yes">Yes</option>
                                            <option value="no">No</option>
                                        </select>
                                        <div class="error-message" id="managementExperience-error"></div>
                                    </div>
                                    <div class="form-group full-width" id="managementExampleSection" style="display: none;">
                                        <label for="managementExample">If yes, please provide an example of your experience managing people or teams <span class="required">*</span></label>
                                        <textarea id="managementExample" name="managementExample" placeholder="Describe a specific example of when you managed people or teams, including the size of the team, your responsibilities, and the outcomes achieved." maxlength="1500"></textarea>
                                        <div class="char-counter" id="managementExample-counter">0 / 1500 characters</div>
                                        <div class="error-message" id="managementExample-error"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Additional Information -->
                            <div class="form-section" id="section-7" data-section="7">
                                <div class="section-header">
                                    <div class="section-number">7</div>
                                    <h3 class="section-title">Additional Information</h3>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group full-width">
                                        <label for="accommodations">Do you require any reasonable accommodations to complete your application or perform the essential functions of this role? (Optional)</label>
                                        <textarea id="accommodations" name="accommodations" placeholder="If you require any reasonable accommodations or have disabilities that need to be addressed, please describe them here. This information will be kept confidential and used only to ensure we can provide appropriate support and make reasonable accommodations as required by law." maxlength="1000"></textarea>
                                        <div class="char-counter" id="accommodations-counter">0 / 1000 characters</div>
                                        <div class="error-message" id="accommodations-error"></div>
                                        <p style="font-size: 12px; color: var(--text-light); margin-top: 8px; line-height: 1.5;">We are committed to providing reasonable accommodations to qualified individuals with disabilities. If you need assistance with the application process or require accommodations, please provide details above and we will work with you to ensure you can participate fully in our recruitment process.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Documents -->
                            <div class="form-section" id="section-8" data-section="8">
                                <div class="section-header">
                                    <div class="section-number">8</div>
                                    <h3 class="section-title">Documents</h3>
                                </div>
                                
                                <div class="form-group full-width">
                                    <label>Resume <span class="required">*</span></label>
                                    <div class="file-upload-wrapper">
                                        <div class="file-upload">
                                            <input type="file" id="resume" name="resume" accept=".pdf,.doc,.docx" required>
                                            <label for="resume" class="file-upload-label">
                                                <div class="file-upload-text">Upload Resume</div>
                                                <div class="file-upload-hint">PDF, DOC, or DOCX<br>Max 10MB</div>
                                            </label>
                                        </div>
                                        <div id="resumeSelected" class="file-selected" style="display: none;">
                                            <span class="file-selected-name" id="resumeFileName"></span>
                                            <button type="button" class="file-selected-remove" id="removeResume"></button>
                                        </div>
                                        <div id="resumePreview" class="file-preview-container"></div>
                                    </div>
                                    <div class="error-message" id="resume-error"></div>
                                </div>
                            </div>

                            <!-- Design Portfolio -->
                            <div class="form-section" id="section-9" data-section="9">
                                <div class="section-header">
                                    <div class="section-number">9</div>
                                    <h3 class="section-title">Design Portfolio</h3>
                                </div>
                                <div class="form-group full-width">
                                    <label>Upload Design Work / Portfolio Samples (Optional but Recommended)</label>
                                    <p class="field-help-text">Please upload examples of marketing materials, presentations, graphics, or other design work you've created. This could include offering memorandums, property listings, presentations, brochures, or similar professional materials.</p>
                                    <div class="file-upload-wrapper">
                                        <div class="file-upload">
                                            <input type="file" id="portfolio" name="portfolioFiles" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.zip" multiple>
                                            <label for="portfolio" class="file-upload-label">
                                                <div class="file-upload-text">Click to upload portfolio files</div>
                                                <div class="file-upload-hint">PDF, DOC, DOCX, JPG, PNG, or ZIP<br>Max 10MB per file  Multiple files allowed</div>
                                            </label>
                                        </div>
                                        <div id="portfolioFiles" class="portfolio-files"></div>
                                        <div id="portfolioPreview" class="portfolio-preview-grid"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Video Introduction -->
                            <div class="form-section" id="section-10" data-section="10">
                                <div class="section-header">
                                    <div class="section-number">10</div>
                                    <h3 class="section-title">Video Introduction</h3>
                                </div>
                                    <div class="form-group full-width">
                                        <label>Video Introduction <span class="required">*</span></label>
                                    <div class="video-instructions">
                                        <h4>Video Guidelines</h4>
                                        <p style="font-size: 14px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 10px;">Please record a short video (under 1 minute) introducing yourself. Share one fun fact or hobby that you have, and explain why you think this role would be a good fit for you and why you would want to be in this role.</p>
                                        <ul>
                                            <li><strong>Quality:</strong> Ensure good lighting and clear audio</li>
                                        </ul>
                                    </div>

                                    <!-- Video Recording Options -->
                                    <div class="video-recording-container">
                                        <div class="video-recording-options">
                                            <button type="button" class="video-option-btn" id="recordOption" onclick="switchToRecord()">
                                                <span class="video-option-icon"></span>
                                                <span class="video-option-text">Record Video</span>
                                            </button>
                                            <button type="button" class="video-option-btn active" id="uploadOption" onclick="switchToUpload()">
                                                <span class="video-option-icon"></span>
                                                <span class="video-option-text">Upload Video</span>
                                            </button>
                                        </div>

                                        <!-- Upload Option -->
                                        <div id="uploadSection" class="file-upload-wrapper">
                                            <div class="file-upload">
                                                <input type="file" id="video1" name="video1" accept="video/*" required>
                                                <label for="video1" class="file-upload-label">
                                                    <div class="file-upload-text">Click to upload video</div>
                                                    <div class="file-upload-hint">Maximum file size: 100MB<br>Supported formats: MP4, MOV, AVI, WMV, WEBM</div>
                                                </label>
                                            </div>
                                            <div id="fileSelected" class="file-selected" style="display: none;">
                                                <span class="file-selected-name" id="fileName"></span>
                                                <button type="button" class="file-selected-remove" id="removeFile"></button>
                                            </div>
                                            <div id="videoUploadPreview" class="file-preview-container"></div>
                                        </div>

                                        <!-- Record Option -->
                                        <div id="recordSection" class="video-preview-container" style="display: none;">
                                            <div id="permissionPrompt" class="permission-prompt" style="display: block;">
                                                <div class="permission-prompt-content">
                                                    <h4>Camera & Microphone Access Required</h4>
                                                    <p>To record your video introduction, we need access to your camera and microphone.</p>
                                                    <div class="permission-steps">
                                                        <div class="permission-step">
                                                            <strong>1.</strong> Click "Allow Camera Access" below
                                                        </div>
                                                        <div class="permission-step">
                                                            <strong>2.</strong> Your browser will ask for permission - click "Allow"
                                                        </div>
                                                        <div class="permission-step">
                                                            <strong>3.</strong> Your camera preview will appear
                                                        </div>
                                                    </div>
                                                    <button type="button" class="btn btn-primary" id="requestPermissionBtn" onclick="requestCameraPermission()" style="margin-top: 20px; padding: 14px 28px;">
                                                        Allow Camera Access
                                                    </button>
                                                    <p style="margin-top: 15px; font-size: 13px; color: var(--text-light);">
                                                        <strong>Note:</strong> If you don't see a permission prompt, check your browser's address bar for a camera/microphone icon and click it to allow permissions.
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="video-preview-wrapper" id="videoPreviewWrapper" style="display: none;">
                                                <video id="videoRecordPreview" class="video-preview" autoplay muted playsinline></video>
                                                <div class="video-overlay" id="videoOverlay" style="display: none;">
                                                    <div class="video-loading">
                                                        <div class="spinner-large"></div>
                                                        <p>Initializing camera...</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="recording-controls" id="recordingControls" style="display: none;">
                                                <div class="recording-controls-primary">
                                                    <button type="button" class="btn btn-primary btn-record" id="startRecordBtn" onclick="startRecording()">
                                                        <span class="btn-icon"></span>
                                                        <span>Start Recording</span>
                                                    </button>
                                                    <button type="button" class="btn btn-danger btn-record" id="stopRecordBtn" onclick="stopRecording()" style="display: none;">
                                                        <span class="btn-icon"></span>
                                                        <span>Stop Recording</span>
                                                    </button>
                                                    <div class="recording-timer-wrapper" id="recordingTimerWrapper" style="display: none;">
                                                        <div class="recording-indicator"></div>
                                                        <div class="recording-timer" id="recordingTimer">00:00</div>
                                                    </div>
                                                </div>
                                                <div class="recording-controls-secondary" id="recordingControlsSecondary" style="display: none;">
                                                    <button type="button" class="btn btn-success" id="useRecordBtn" onclick="useRecordedVideo()">
                                                        <span>Use This Video</span>
                                                    </button>
                                                    <button type="button" class="btn btn-secondary" id="retryRecordBtn" onclick="retryRecording()">
                                                        <span>Record Again</span>
                                                    </button>
                                                </div>
                                            </div>
                                            <div id="recordingStatus" class="recording-status" style="display: none;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="submit-section">
                                <p class="submit-section-note" style="margin-bottom: 24px;">Before submitting, please review all sections and ensure all information is accurate and complete. You will receive a confirmation email with your Application ID upon successful submission.</p>
                                
                                <!-- Consent Checkboxes -->
                                <div style="background: var(--bg-light); border: 1px solid var(--border); padding: 24px; margin-bottom: 24px; text-align: left;">
                                    <h4 style="font-size: 15px; font-weight: 600; color: var(--text-primary); margin-bottom: 16px;">Required Acknowledgments</h4>
                                    <div class="checkbox-group" style="display: flex; flex-direction: column; gap: 14px;">
                                        <label class="checkbox-item" style="display: flex; align-items: flex-start; gap: 12px; cursor: pointer; font-size: 14px; line-height: 1.6;">
                                            <input type="checkbox" id="consentAccuracy" name="consentAccuracy" required style="margin-top: 3px; width: 18px; height: 18px; accent-color: var(--primary); flex-shrink: 0;">
                                            <span style="color: var(--text-secondary);">I certify that all information provided in this application is true, accurate, and complete to the best of my knowledge. I understand that any misrepresentation or omission of material facts may result in disqualification from consideration or termination of contract if discovered after engagement. <span class="required">*</span></span>
                                        </label>
                                        <label class="checkbox-item" style="display: flex; align-items: flex-start; gap: 12px; cursor: pointer; font-size: 14px; line-height: 1.6;">
                                            <input type="checkbox" id="consentPrivacy" name="consentPrivacy" required style="margin-top: 3px; width: 18px; height: 18px; accent-color: var(--primary); flex-shrink: 0;">
                                            <span style="color: var(--text-secondary);">I consent to the collection, processing, and storage of my personal information for recruitment and hiring purposes. I understand that my data will be kept confidential and used solely for recruitment purposes. I acknowledge that I have read and understood the Privacy Policy and Data Protection information provided. <span class="required">*</span></span>
                                        </label>
                                        <label class="checkbox-item" style="display: flex; align-items: flex-start; gap: 12px; cursor: pointer; font-size: 14px; line-height: 1.6;">
                                            <input type="checkbox" id="consentTerms" name="consentTerms" required style="margin-top: 3px; width: 18px; height: 18px; accent-color: var(--primary); flex-shrink: 0;">
                                            <span style="color: var(--text-secondary);">I acknowledge that submission of this application does not guarantee contract engagement or create any contractual obligation. I understand that the company reserves the right to reject any application, discontinue the recruitment process, or modify role requirements at any time. <span class="required">*</span></span>
                                        </label>
                                        <label class="checkbox-item" style="display: flex; align-items: flex-start; gap: 12px; cursor: pointer; font-size: 14px; line-height: 1.6;">
                                            <input type="checkbox" id="consentDataProcessing" name="consentDataProcessing" required style="margin-top: 3px; width: 18px; height: 18px; accent-color: var(--primary); flex-shrink: 0;">
                                            <span style="color: var(--text-secondary);">I consent to the processing of my personal data, including sensitive information, for recruitment purposes. I understand that I have the right to request access, correction, or deletion of my data at any time, and I acknowledge the company's data retention policy as outlined in the Privacy Policy. <span class="required">*</span></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                                    <button type="button" class="btn btn-secondary" id="previewBtn" onclick="showApplicationSummary()" style="min-width: 180px;">
                                        Preview Application
                                    </button>
                                    <button type="submit" class="submit-btn" id="submitBtn" style="position: relative;">
                                        <span id="submitBtnText">Submit Application</span>
                                        <span id="submitBtnSpinner" style="display: none; margin-left: 8px; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px;">Processing...</span>
                                    </button>
                                    <p style="font-size: 10px; color: var(--text-light); text-align: center; margin-top: 10px; text-transform: uppercase; letter-spacing: 0.8px; width: 100%;">SSL Encrypted Transmission</p>
                                </div>
                                <div style="margin-top: 16px; padding: 16px; background: var(--bg-light); border-left: 3px solid var(--primary); border-radius: 0;">
                                    <p style="font-size: 13px; color: var(--text-primary); margin-bottom: 8px; font-weight: 600;">What Happens Next?</p>
                                    <ul style="font-size: 12px; color: var(--text-secondary); line-height: 1.7; margin: 0; padding-left: 20px;">
                                        <li>Your application will be reviewed by our hiring team</li>
                                        <li>We typically respond within 1-2 weeks</li>
                                        <li>Selected candidates will be contacted via email</li>
                                        <li>You will receive a confirmation email with your Application ID upon submission</li>
                                    </ul>
                                </div>
                            </div>
                        </form>
                    </div>

                    <div class="footer">
                        <div class="footer-content">
                            <div class="footer-section">
                                <h4>Application Process</h4>
                                <p style="margin-bottom: 12px;">All applications are reviewed by our hiring team. We typically respond within 1-2 weeks. Selected candidates will be contacted via the email address provided in your application.</p>
                                <p style="font-size: 13px; color: var(--text-light);">Application ID will be provided upon successful submission for your records.</p>
                            </div>
                            
                            <div class="footer-section">
                                <h4>Data Protection & Privacy</h4>
                                <p style="font-size: 13px; line-height: 1.7; color: var(--text-secondary);">We are committed to protecting your personal information. All data is processed in accordance with applicable data protection regulations. Your information is used solely for recruitment purposes and is not shared with unauthorized third parties.</p>
                            </div>
                            
                            <div class="disclaimer-box" style="background: var(--bg-light); border: 1px solid var(--border); padding: 24px; border-radius: 0; margin-top: 24px;">
                                <h4 style="font-size: 13px; font-weight: 600; color: var(--text-primary); margin-bottom: 16px; text-transform: uppercase; letter-spacing: 0.8px;">Legal & Compliance</h4>
                                
                                <p style="margin-bottom: 12px; line-height: 1.7;"><strong>Data Privacy & Collection:</strong> By submitting this application, you consent to the collection, processing, and storage of your personal information, including but not limited to your name, contact information, resume, video submissions, and responses to application questions. This information will be used solely for recruitment and hiring purposes. Your data will be kept confidential and will not be shared with third parties except as necessary for the recruitment process. You have the right to request access, correction, or deletion of your data at any time.</p>
                                
                                <p style="margin-bottom: 12px; line-height: 1.7;"><strong>Data Retention:</strong> We retain application data for a period of 24 months from the date of submission, unless you request earlier deletion. If you are engaged, your application data will be retained as part of your employment records in accordance with applicable legal requirements. If you are not selected, your data will be securely deleted after the retention period, unless you have provided explicit consent for us to retain it for future opportunities.</p>
                                
                                <p style="margin-bottom: 12px; line-height: 1.7;"><strong>International Data Transfers (GDPR):</strong> If you are located in the European Economic Area (EEA), United Kingdom, or other jurisdictions with data protection laws, you have additional rights under applicable regulations, including the right to data portability, the right to object to processing, and the right to lodge a complaint with a supervisory authority. We process your data based on your consent and our legitimate interest in evaluating candidates for employment opportunities.</p>
                                
                                <p style="margin-bottom: 12px; line-height: 1.7;"><strong>Security & Encryption:</strong> All data transmitted through this portal is encrypted using industry-standard SSL/TLS protocols. Your information is stored securely and accessed only by authorized personnel involved in the recruitment process.</p>
                                
                                <p style="margin-bottom: 12px; line-height: 1.7;"><strong>Application Acknowledgment:</strong> You acknowledge that all information provided in this application is true and accurate to the best of your knowledge. Any misrepresentation or omission of material facts may result in disqualification from consideration or termination of contract if discovered after engagement.</p>
                                
                                <p style="margin-bottom: 12px; line-height: 1.7;"><strong>No Guarantee of Engagement:</strong> Submission of this application does not guarantee contract engagement or create any contractual obligation. We reserve the right to reject any application, discontinue the recruitment process, or modify role requirements at any time.</p>
                                
                                <p style="margin-bottom: 12px; line-height: 1.7;"><strong>Duties and Responsibilities:</strong> The duties and responsibilities described in this job posting are not exhaustive and additional assignments, duties, or responsibilities may be required of this position. Assignments, duties, and responsibilities may be changed at any time, with or without notice, by the company in its sole discretion.</p>
                                
                                <p style="line-height: 1.7;"><strong>Equal Employment Opportunity:</strong> We are committed to providing equal employment opportunities to all employees and applicants for employment without regard to race, color, creed, religion, sex, pregnancy, national origin, ancestry, citizenship status, age, marital or partnership status, sexual orientation, gender identity or expression, disability, genetic predisposition, veteran or military status, status as a victim of domestic violence, a sex offense or stalking, or any other class or status in accordance with applicable federal, state and local laws. This policy applies to all terms and conditions of employment, including but not limited to hiring, placement, promotion, termination, transfer, leave of absence, compensation, and training.</p>
                            </div>
                            
                            <div class="footer-links">
                                <a href="#" onclick="event.preventDefault(); alert('Privacy Policy: We collect and process your application data solely for recruitment purposes. Your information is kept confidential and will not be shared with third parties without your consent.'); return false;">Privacy Policy</a>
                                <span></span>
                                <a href="#" onclick="event.preventDefault(); alert('Terms of Service: By submitting this application, you agree that all information provided is accurate and complete. You understand that submission does not guarantee contract engagement and that we reserve the right to reject any application at our discretion.'); return false;">Terms</a>
                                <span></span>
                                <span style="color: var(--text-light);"> 2024 Commercial Real Estate Brokerage. All rights reserved.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Auto-save Indicator -->
    <div class="save-indicator" id="saveIndicator"></div>

    <!-- File Preview Modal -->
    <div class="preview-modal" id="previewModal">
        <div class="preview-modal-content">
            <button class="preview-modal-close" onclick="closePreviewModal()"></button>
            <div class="preview-modal-body" id="previewModalBody"></div>
        </div>
    </div>

    <!-- Application Summary Modal -->
    <div class="summary-modal" id="summaryModal">
        <div class="summary-modal-content">
            <div class="summary-modal-header">
                <h3>Application Summary</h3>
                <button class="summary-modal-close" onclick="closeApplicationSummary()"></button>
            </div>
            <div class="summary-modal-body" id="summaryModalBody">
                <!-- Content will be generated dynamically -->
            </div>
            <div class="summary-modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeApplicationSummary()">Back to Edit</button>
                <button type="button" class="submit-btn" onclick="submitFromSummary()">Confirm & Submit</button>
            </div>
        </div>
    </div>

    <script>
        // Toggle job description on mobile
        function toggleJobDescription() {
            const toggles = document.querySelectorAll('.job-description-toggle');
            const contents = document.querySelectorAll('.job-description-content');
            const jobToggle = toggles[toggles.length - 1]; // Last toggle is for job description
            const jobContent = contents[contents.length - 1]; // Last content is for job description
            
            if (jobContent && jobToggle) {
                if (jobContent.classList.contains('collapsed')) {
                    jobContent.classList.remove('collapsed');
                    jobToggle.textContent = 'Hide Job Details';
                    jobToggle.classList.remove('collapsed');
                } else {
                    jobContent.classList.add('collapsed');
                    jobToggle.textContent = 'View Job Details';
                    jobToggle.classList.add('collapsed');
                }
            }
        }

        // Toggle company details on mobile
        function toggleCompanyDetails() {
            const toggles = document.querySelectorAll('.job-description-toggle');
            const contents = document.querySelectorAll('.company-content');
            const companyToggle = toggles[0]; // First toggle is for company
            const companyContent = contents[0]; // First content is for company
            
            if (companyContent && companyToggle) {
                if (companyContent.classList.contains('collapsed')) {
                    companyContent.classList.remove('collapsed');
                    companyToggle.textContent = 'Hide Company Details';
                    companyToggle.classList.remove('collapsed');
                } else {
                    companyContent.classList.add('collapsed');
                    companyToggle.textContent = 'View Company Details';
                    companyToggle.classList.add('collapsed');
                }
            }
        }

        // Toggle navigation sidebar on mobile
        function toggleNavSidebar() {
            const sidebar = document.getElementById('navSidebar');
            if (sidebar) {
                sidebar.classList.toggle('collapsed');
            }
        }

        // Video Recording Functions
        let mediaRecorder = null;
        let recordedChunks = [];
        let recordedBlob = null;
        let recordingStream = null;
        let recordingTimerInterval = null;
        let recordingStartTime = null;
        let globalShowMessage = null; // Will be set in DOMContentLoaded

        // Voice-to-Text Functionality
        let recognition = null;
        let currentTextarea = null;
        let isRecording = false;

        // Initialize Speech Recognition
        function initSpeechRecognition() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            
            if (!SpeechRecognition) {
                console.log('Speech recognition not supported in this browser');
                return false;
            }

            recognition = new SpeechRecognition();
            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.lang = 'en-US';

            recognition.onstart = function() {
                isRecording = true;
                if (currentTextarea) {
                    const btn = currentTextarea.parentElement.querySelector('.voice-btn');
                    const status = currentTextarea.parentElement.querySelector('.voice-status');
                    if (btn) btn.classList.add('recording');
                    if (status) {
                        status.classList.add('show', 'recording');
                        status.textContent = 'Listening...';
                    }
                }
            };

            recognition.onresult = function(event) {
                let interimTranscript = '';
                let finalTranscript = '';

                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    if (event.results[i].isFinal) {
                        finalTranscript += transcript + ' ';
                    } else {
                        interimTranscript += transcript;
                    }
                }

                if (currentTextarea) {
                    const currentValue = currentTextarea.value;
                    const cursorPos = currentTextarea.selectionStart;
                    const textBefore = currentValue.substring(0, cursorPos);
                    const textAfter = currentValue.substring(cursorPos);
                    
                    currentTextarea.value = textBefore + finalTranscript + interimTranscript + textAfter;
                    currentTextarea.selectionStart = currentTextarea.selectionEnd = cursorPos + finalTranscript.length + interimTranscript.length;
                    
                    // Trigger input event for auto-save and character counter
                    currentTextarea.dispatchEvent(new Event('input', { bubbles: true }));
                }
            };

            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                stopVoiceRecording();
                
                if (currentTextarea) {
                    const status = currentTextarea.parentElement.querySelector('.voice-status');
                    if (status) {
                        status.textContent = 'Error: ' + event.error;
                        status.classList.remove('recording');
                        setTimeout(() => {
                            status.classList.remove('show');
                        }, 3000);
                    }
                }
            };

            recognition.onend = function() {
                stopVoiceRecording();
            };

            return true;
        }

        function startVoiceRecording(textarea) {
            if (!recognition && !initSpeechRecognition()) {
                alert('Voice-to-text is not supported in your browser. Please use Chrome, Edge, or another supported browser.');
                return;
            }

            // Stop any existing recording
            if (isRecording && currentTextarea !== textarea) {
                stopVoiceRecording();
            }

            currentTextarea = textarea;
            
            try {
                recognition.start();
            } catch (error) {
                if (error.name === 'InvalidStateError') {
                    // Already started, restart it
                    recognition.stop();
                    setTimeout(() => {
                        recognition.start();
                    }, 100);
                } else {
                    console.error('Error starting recognition:', error);
                    alert('Unable to start voice recording. Please check your microphone permissions.');
                }
            }
        }

        function stopVoiceRecording() {
            if (recognition && isRecording) {
                try {
                    recognition.stop();
                } catch (error) {
                    console.error('Error stopping recognition:', error);
                }
            }
            
            isRecording = false;
            
            if (currentTextarea) {
                const btn = currentTextarea.parentElement.querySelector('.voice-btn');
                const status = currentTextarea.parentElement.querySelector('.voice-status');
                if (btn) btn.classList.remove('recording');
                if (status) {
                    status.classList.remove('recording');
                    status.textContent = 'Stopped';
                    setTimeout(() => {
                        status.classList.remove('show');
                    }, 2000);
                }
            }
            
            currentTextarea = null;
        }

        function toggleVoiceRecording(textarea) {
            if (isRecording && currentTextarea === textarea) {
                stopVoiceRecording();
            } else {
                startVoiceRecording(textarea);
            }
        }

        // Add voice buttons to all textareas on page load
        function addVoiceButtonsToTextareas() {
            const textareas = document.querySelectorAll('textarea');
            
            textareas.forEach(textarea => {
                // Skip if already has voice button
                if (textarea.parentElement.querySelector('.voice-btn')) {
                    return;
                }

                // Wrap textarea in voice-input-wrapper if not already
                if (!textarea.parentElement.classList.contains('voice-input-wrapper')) {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'voice-input-wrapper';
                    textarea.parentNode.insertBefore(wrapper, textarea);
                    wrapper.appendChild(textarea);
                }

                // Create voice button
                const voiceBtn = document.createElement('button');
                voiceBtn.type = 'button';
                voiceBtn.className = 'voice-btn';
                voiceBtn.title = 'Click to start voice-to-text. Click again to stop.';
                voiceBtn.setAttribute('aria-label', 'Voice to text');
                voiceBtn.onclick = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    toggleVoiceRecording(textarea);
                };

                // Create status indicator
                const status = document.createElement('div');
                status.className = 'voice-status';
                status.textContent = 'Ready';

                // Insert button and status
                const wrapper = textarea.parentElement;
                wrapper.appendChild(voiceBtn);
                wrapper.appendChild(status);
            });
        }

        function switchToRecord() {
            document.getElementById('recordOption').classList.add('active');
            document.getElementById('uploadOption').classList.remove('active');
            document.getElementById('uploadSection').style.display = 'none';
            document.getElementById('recordSection').style.display = 'block';
            document.getElementById('recordSection').classList.add('active');
            
            // Clear any uploaded file
            const videoInput = document.getElementById('video1');
            if (videoInput) videoInput.value = '';
            const fileSelected = document.getElementById('fileSelected');
            if (fileSelected) fileSelected.style.display = 'none';
            
            // Show permission prompt if we don't have access yet
            const permissionPrompt = document.getElementById('permissionPrompt');
            const videoPreviewWrapper = document.getElementById('videoPreviewWrapper');
            const recordingControls = document.getElementById('recordingControls');
            
            if (!recordingStream) {
                if (permissionPrompt) permissionPrompt.style.display = 'block';
                if (videoPreviewWrapper) videoPreviewWrapper.style.display = 'none';
                if (recordingControls) recordingControls.style.display = 'none';
            } else {
                if (permissionPrompt) permissionPrompt.style.display = 'none';
                if (videoPreviewWrapper) videoPreviewWrapper.style.display = 'block';
                if (recordingControls) recordingControls.style.display = 'block';
            }
        }

        function switchToUpload() {
            document.getElementById('uploadOption').classList.add('active');
            document.getElementById('recordOption').classList.remove('active');
            document.getElementById('recordSection').style.display = 'none';
            document.getElementById('uploadSection').style.display = 'block';
            
            // Stop camera if recording
            stopCamera();
        }

        async function requestCameraPermission() {
            const permissionPrompt = document.getElementById('permissionPrompt');
            const videoPreviewWrapper = document.getElementById('videoPreviewWrapper');
            const recordingControls = document.getElementById('recordingControls');
            const requestBtn = document.getElementById('requestPermissionBtn');
            
            if (requestBtn) {
                requestBtn.disabled = true;
                requestBtn.textContent = 'Requesting Permission...';
            }
            
            try {
                // Check if browser supports getUserMedia
                if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                    throw new Error('Your browser does not support video recording. Please use a modern browser like Chrome, Firefox, or Edge.');
                }
                
                // Request permission
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        width: { ideal: 1280 },
                        height: { ideal: 720 },
                        facingMode: 'user'
                    }, 
                    audio: true 
                });
                
                // Permission granted - hide prompt, show preview
                recordingStream = stream;
                
                if (permissionPrompt) permissionPrompt.style.display = 'none';
                if (videoPreviewWrapper) videoPreviewWrapper.style.display = 'block';
                if (recordingControls) recordingControls.style.display = 'block';
                
                const videoPreview = document.getElementById('videoRecordPreview');
                if (videoPreview) {
                    videoPreview.srcObject = stream;
                    videoPreview.onloadedmetadata = () => {
                        if (globalShowMessage) {
                            globalShowMessage('Camera access granted! You can now start recording.', 'success');
                        }
                    };
                }
                
            } catch (error) {
                console.error('Error requesting camera permission:', error);
                
                if (requestBtn) {
                    requestBtn.disabled = false;
                    requestBtn.textContent = 'Allow Camera Access';
                }
                
                let errorMsg = '';
                let helpText = '';
                
                if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {
                    errorMsg = 'Camera permission denied';
                    helpText = 'Please click the camera/microphone icon in your browser\'s address bar and select "Allow". Then refresh this page or click the button again.';
                } else if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {
                    errorMsg = 'No camera found';
                    helpText = 'Please connect a camera to your device or use the "Upload Video" option instead.';
                } else if (error.name === 'NotReadableError' || error.name === 'TrackStartError') {
                    errorMsg = 'Camera is being used by another application';
                    helpText = 'Please close other applications using your camera and try again.';
                } else {
                    errorMsg = 'Unable to access camera';
                    helpText = error.message || 'Please check your camera settings and try again, or use the upload option.';
                }
                
                if (permissionPrompt) {
                    const content = permissionPrompt.querySelector('.permission-prompt-content');
                    if (content) {
                        content.innerHTML = `
                            <h4 style="color: var(--error);"> ${errorMsg}</h4>
                            <p style="color: var(--text-secondary); margin-bottom: 20px;">${helpText}</p>
                            <button type="button" class="btn btn-primary" onclick="requestCameraPermission()" style="margin-right: 10px;">
                                Try Again
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="switchToUpload()">
                                Use Upload Instead
                            </button>
                        `;
                    }
                }
                
                if (globalShowMessage) {
                    globalShowMessage(errorMsg + '. ' + helpText, 'error');
                }
            }
        }

        async function initializeCamera() {
            const videoOverlay = document.getElementById('videoOverlay');
            const videoPreview = document.getElementById('videoRecordPreview');
            const startBtn = document.getElementById('startRecordBtn');
            const statusDiv = document.getElementById('recordingStatus');
            
            // If we already have a stream, just show the preview
            if (recordingStream) {
                if (videoPreview) {
                    videoPreview.srcObject = recordingStream;
                }
                if (startBtn) {
                    startBtn.style.display = 'flex';
                    startBtn.disabled = false;
                }
                return;
            }
            
            // Otherwise, request permission first
            requestCameraPermission();
            return;
            
            try {
                // Show loading state
                if (videoOverlay) videoOverlay.style.display = 'flex';
                if (startBtn) startBtn.style.display = 'none';
                if (statusDiv) {
                    statusDiv.textContent = 'Requesting camera access...';
                    statusDiv.className = 'recording-status';
                    statusDiv.style.display = 'block';
                }
                
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        width: { ideal: 1280 },
                        height: { ideal: 720 },
                        facingMode: 'user'
                    }, 
                    audio: true 
                });
                
                recordingStream = stream;
                
                if (videoPreview) {
                    videoPreview.srcObject = stream;
                    videoPreview.onloadedmetadata = () => {
                        if (videoOverlay) videoOverlay.style.display = 'none';
                        if (startBtn) startBtn.style.display = 'flex';
                        if (statusDiv) statusDiv.style.display = 'none';
                    };
                } else {
                    if (videoOverlay) videoOverlay.style.display = 'none';
                    if (startBtn) startBtn.style.display = 'flex';
                }
            } catch (error) {
                console.error('Error accessing camera:', error);
                if (videoOverlay) videoOverlay.style.display = 'none';
                
                let errorMsg = 'Unable to access camera. ';
                if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {
                    errorMsg += 'Please allow camera and microphone permissions in your browser settings.';
                } else if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {
                    errorMsg += 'No camera found. Please connect a camera or use the upload option.';
                } else {
                    errorMsg += 'Please check your camera settings and try again, or use the upload option.';
                }
                
                if (statusDiv) {
                    statusDiv.textContent = errorMsg;
                    statusDiv.className = 'recording-status error';
                    statusDiv.style.display = 'block';
                }
                
                if (globalShowMessage) {
                    globalShowMessage(errorMsg, 'error');
                }
                
                // Auto-switch to upload after 3 seconds
                setTimeout(() => {
                    switchToUpload();
                }, 3000);
            }
        }

        function startRecording() {
            if (!recordingStream) {
                if (globalShowMessage) {
                    globalShowMessage('Camera not initialized. Please wait for camera to load.', 'error');
                }
                initializeCamera();
                setTimeout(() => {
                    if (recordingStream) {
                        startRecording();
                    }
                }, 1000);
                return;
            }

            recordedChunks = [];
            let options = { mimeType: 'video/webm;codecs=vp9,opus' };
            
            // Check if the codec is supported
            if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                options = { mimeType: 'video/webm' };
                if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                    options = {}; // Use default
                }
            }
            
            try {
                mediaRecorder = new MediaRecorder(recordingStream, options);
            } catch (e) {
                console.error('Error creating MediaRecorder:', e);
                // Fallback to default
                try {
                    mediaRecorder = new MediaRecorder(recordingStream);
                } catch (e2) {
                    console.error('Error creating MediaRecorder with default options:', e2);
                    if (globalShowMessage) {
                        globalShowMessage('Unable to start recording. Your browser may not support video recording. Please use the upload option instead.', 'error');
                    }
                    return;
                }
            }

            mediaRecorder.ondataavailable = (event) => {
                if (event.data.size > 0) {
                    recordedChunks.push(event.data);
                }
            };

            mediaRecorder.onstop = () => {
                recordedBlob = new Blob(recordedChunks, { type: 'video/webm' });
                const videoPreview = document.getElementById('videoRecordPreview');
                const stopBtn = document.getElementById('stopRecordBtn');
                const useBtn = document.getElementById('useRecordBtn');
                const retryBtn = document.getElementById('retryRecordBtn');
                const timerWrapper = document.getElementById('recordingTimerWrapper');
                const statusDiv = document.getElementById('recordingStatus');
                const controlsSecondary = document.getElementById('recordingControlsSecondary');
                
                if (videoPreview) {
                    videoPreview.srcObject = null;
                    const videoUrl = URL.createObjectURL(recordedBlob);
                    videoPreview.src = videoUrl;
                    videoPreview.controls = true;
                    videoPreview.muted = false;
                }
                
                if (stopBtn) stopBtn.style.display = 'none';
                if (timerWrapper) timerWrapper.style.display = 'none';
                if (controlsSecondary) controlsSecondary.style.display = 'flex';
                if (useBtn) useBtn.style.display = 'inline-flex';
                if (retryBtn) retryBtn.style.display = 'inline-flex';
                
                if (statusDiv) {
                    statusDiv.textContent = 'Recording complete. Review your video below.';
                    statusDiv.className = 'recording-status stopped';
                    statusDiv.style.display = 'block';
                }
            };

            mediaRecorder.start();
            recordingStartTime = Date.now();
            
            const startBtn = document.getElementById('startRecordBtn');
            const stopBtn = document.getElementById('stopRecordBtn');
            const timerWrapper = document.getElementById('recordingTimerWrapper');
            const statusDiv = document.getElementById('recordingStatus');
            const controlsSecondary = document.getElementById('recordingControlsSecondary');
            
            if (startBtn) startBtn.style.display = 'none';
            if (stopBtn) stopBtn.style.display = 'flex';
            if (stopBtn) stopBtn.classList.add('recording');
            if (timerWrapper) timerWrapper.style.display = 'flex';
            if (controlsSecondary) controlsSecondary.style.display = 'none';
            if (statusDiv) {
                statusDiv.textContent = 'Recording in progress...';
                statusDiv.className = 'recording-status recording';
                statusDiv.style.display = 'block';
            }

            // Start timer
            recordingTimerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - recordingStartTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('recordingTimer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // Warn at 60 seconds
                if (elapsed >= 60) {
                    document.getElementById('recordingStatus').textContent = ' Recording over 1 minute. Please keep it under 1 minute.';
                }
            }, 1000);
        }

        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
            }
            
            // Don't stop the stream tracks here - we need them for preview
            // They'll be stopped when switching to upload or on page unload
            
            if (recordingTimerInterval) {
                clearInterval(recordingTimerInterval);
                recordingTimerInterval = null;
            }
            
            const stopBtn = document.getElementById('stopRecordBtn');
            if (stopBtn) stopBtn.classList.remove('recording');
        }

        function useRecordedVideo() {
            if (!recordedBlob) {
                if (globalShowMessage) {
                    globalShowMessage('No video recorded. Please record a video first.', 'error');
                } else {
                    alert('No video recorded. Please record a video first.');
                }
                return;
            }

            // Convert blob to file
            const file = new File([recordedBlob], `video-${Date.now()}.webm`, { type: 'video/webm' });
            
            // Create a FileList-like object and assign to input
            const dataTransfer = new DataTransfer();
            dataTransfer.items.add(file);
            const videoInput = document.getElementById('video1');
            videoInput.files = dataTransfer.files;

            // Show file selected
            const fileSelected = document.getElementById('fileSelected');
            const fileName = document.getElementById('fileName');
            if (fileSelected && fileName) {
                fileName.textContent = file.name;
                fileSelected.style.display = 'flex';
            }

            // Switch to upload view to show the file
            switchToUpload();
            if (globalShowMessage) {
                globalShowMessage('Video recorded successfully! You can review it in the upload section.', 'success');
            }
            
            // Update progress and auto-save
            if (window.updateProgress) {
                window.updateProgress();
            }
            if (window.autoSave) {
                window.autoSave();
            }
        }

        function retryRecording() {
            recordedBlob = null;
            recordedChunks = [];
            
            const videoPreview = document.getElementById('videoRecordPreview');
            const useBtn = document.getElementById('useRecordBtn');
            const retryBtn = document.getElementById('retryRecordBtn');
            const statusDiv = document.getElementById('recordingStatus');
            const controlsSecondary = document.getElementById('recordingControlsSecondary');
            
            if (videoPreview) {
                videoPreview.src = '';
                videoPreview.srcObject = null;
                videoPreview.controls = false;
            }
            
            if (useBtn) useBtn.style.display = 'none';
            if (retryBtn) retryBtn.style.display = 'none';
            if (controlsSecondary) controlsSecondary.style.display = 'none';
            if (statusDiv) statusDiv.style.display = 'none';
            
            initializeCamera();
        }

        function stopCamera() {
            if (recordingStream) {
                recordingStream.getTracks().forEach(track => track.stop());
                recordingStream = null;
            }
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
            }
            if (recordingTimerInterval) {
                clearInterval(recordingTimerInterval);
                recordingTimerInterval = null;
            }
            
            const videoPreview = document.getElementById('videoRecordPreview');
            if (videoPreview) {
                videoPreview.srcObject = null;
                videoPreview.src = '';
            }
        }

        // Clean up camera on page unload
        window.addEventListener('beforeunload', stopCamera);

        // Initialize sections as collapsed on mobile
        window.addEventListener('load', function() {
            if (window.innerWidth <= 768) {
                // Collapse job description sections
                const contents = document.querySelectorAll('.job-description-content');
                const toggles = document.querySelectorAll('.job-description-toggle');
                contents.forEach((content, index) => {
                    if (content && toggles[index]) {
                        content.classList.add('collapsed');
                        toggles[index].classList.add('collapsed');
                    }
                });
                
                // Collapse navigation sidebar by default on mobile
                const navSidebar = document.getElementById('navSidebar');
                if (navSidebar) {
                    navSidebar.classList.add('collapsed');
                }
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            // Initialize voice-to-text
            initSpeechRecognition();
            addVoiceButtonsToTextareas();
            
            const form = document.getElementById('applicationForm');
            const messageDiv = document.getElementById('message');
            const submitBtn = document.getElementById('submitBtn');
            const progressFill = document.getElementById('progressFill');
            const progressPercentage = document.getElementById('progressPercentage');
            const saveIndicator = document.getElementById('saveIndicator');
            const navList = document.getElementById('navList');
            
            // Portal-specific initialization
            if (progressPercentage) {
                progressPercentage.textContent = '0% Complete';
            }

            // Make showMessage globally accessible for video recording
            globalShowMessage = function(text, type) {
                messageDiv.textContent = text;
                messageDiv.className = `message ${type}`;
                messageDiv.style.display = 'block';
                messageDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            };

            // Section navigation
            const sections = [
                { id: 1, title: 'Personal Information' },
                { id: 2, title: 'Education' },
                { id: 3, title: 'Professional Experience' },
                { id: 4, title: 'Technical Skills' },
                { id: 5, title: 'Availability' },
                { id: 6, title: 'Assessment' },
                { id: 7, title: 'Additional Information' },
                { id: 8, title: 'Documents' },
                { id: 9, title: 'Design Portfolio' },
                { id: 10, title: 'Video Introduction' }
            ];

            // Build navigation
            sections.forEach(section => {
                const li = document.createElement('li');
                li.className = 'nav-item';
                const a = document.createElement('a');
                a.href = `#section-${section.id}`;
                a.className = 'nav-link';
                a.textContent = `${section.id}. ${section.title}`;
                a.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById(`section-${section.id}`).scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
                li.appendChild(a);
                navList.appendChild(li);
            });

            // Make updateProgress and autoSave globally accessible
            window.updateProgress = function() {
                const requiredFields = form.querySelectorAll('[required]');
                const filledFields = Array.from(requiredFields).filter(field => {
                    if (field.type === 'checkbox' || field.type === 'radio') {
                        const name = field.name;
                        return form.querySelector(`[name="${name}"]:checked`);
                    }
                    if (field.type === 'file') {
                        return field.files && field.files.length > 0;
                    }
                    return field.value.trim() !== '';
                });
                
                const progress = Math.round((filledFields.length / requiredFields.length) * 100);
                progressFill.style.width = progress + '%';
                const progressPercentageEl = document.getElementById('progressPercentage');
                if (progressPercentageEl) {
                    progressPercentageEl.textContent = progress + '% Complete';
                }

                // Update nav links
                sections.forEach(section => {
                    const sectionEl = document.getElementById(`section-${section.id}`);
                    const navLink = navList.querySelector(`a[href="#section-${section.id}"]`);
                    if (sectionEl) {
                        const sectionFields = sectionEl.querySelectorAll('[required]');
                        const sectionFilled = Array.from(sectionFields).filter(field => {
                            if (field.type === 'checkbox' || field.type === 'radio') {
                                const name = field.name;
                                return form.querySelector(`[name="${name}"]:checked`);
                            }
                            if (field.type === 'file') {
                                return field.files && field.files.length > 0;
                            }
                            return field.value.trim() !== '';
                        });
                        if (sectionFilled.length === sectionFields.length && sectionFields.length > 0) {
                            navLink.classList.add('completed');
                        } else {
                            navLink.classList.remove('completed');
                        }
                    }
                });
            }

            // Character counters
            const textareas = form.querySelectorAll('textarea[maxlength]');
            textareas.forEach(textarea => {
                const maxLength = parseInt(textarea.getAttribute('maxlength'));
                const counter = document.getElementById(textarea.id + '-counter');
                if (counter) {
                    function updateCounter() {
                        const length = textarea.value.length;
                        const remaining = maxLength - length;
                        counter.textContent = `${length} / ${maxLength} characters${remaining < 100 ? ` (${remaining} remaining)` : ''}`;
                        counter.classList.remove('warning', 'error');
                        if (length > maxLength * 0.9) {
                            counter.classList.add('warning');
                        }
                        if (length >= maxLength) {
                            counter.classList.add('error');
                        }
                    }
                    textarea.addEventListener('input', updateCounter);
                    updateCounter();
                }
            });

            // Auto-save to localStorage
            let saveTimeout;
            let lastSaveTime = null;
            
            window.autoSave = function() {
                clearTimeout(saveTimeout);
                saveIndicator.textContent = 'Saving...';
                saveIndicator.className = 'save-indicator show saving';
                
                saveTimeout = setTimeout(() => {
                    try {
                        const formData = new FormData(form);
                        const data = {
                            _savedAt: new Date().toISOString(),
                            _version: '1.0'
                        };
                        
                        // Save all form fields (except files - they can't be saved to localStorage)
                        for (let [key, value] of formData.entries()) {
                            // Skip file inputs - they can't be saved to localStorage
                            const field = form.querySelector(`[name="${key}"]`);
                            if (field && field.type === 'file') {
                                continue;
                            }
                            
                            if (data[key]) {
                                if (Array.isArray(data[key])) {
                                    data[key].push(value);
                                } else {
                                    data[key] = [data[key], value];
                                }
                            } else {
                                data[key] = value;
                            }
                        }
                        
                        // Save to localStorage
                        localStorage.setItem('applicationDraft', JSON.stringify(data));
                        lastSaveTime = new Date();
                        
                        // Update save indicator
                        saveIndicator.textContent = 'Draft saved';
                        saveIndicator.className = 'save-indicator show saved';
                        
                        // Also save to sessionStorage as backup
                        sessionStorage.setItem('applicationDraft', JSON.stringify(data));
                        
                        setTimeout(() => {
                            saveIndicator.classList.remove('show');
                        }, 2000);
                    } catch (error) {
                        console.error('Error saving draft:', error);
                        saveIndicator.textContent = 'Save failed';
                        saveIndicator.className = 'save-indicator show error';
                        setTimeout(() => {
                            saveIndicator.classList.remove('show');
                        }, 3000);
                    }
                }, 800);
            }
            
            // Auto-save on page unload
            window.addEventListener('beforeunload', () => {
                if (window.autoSave) {
                    window.autoSave();
                }
            });
            
            // Show last save time in welcome section
            function updateLastSaveDisplay() {
                const draft = localStorage.getItem('applicationDraft');
                if (draft) {
                    try {
                        const data = JSON.parse(draft);
                        if (data._savedAt) {
                            const savedDate = new Date(data._savedAt);
                            const timeAgo = getTimeAgo(savedDate);
                            const saveInfoEl = document.getElementById('lastSaveInfo');
                            if (saveInfoEl) {
                                saveInfoEl.textContent = `Last saved: ${timeAgo}`;
                                saveInfoEl.style.display = 'block';
                            }
                        }
                    } catch (e) {
                        console.error('Error parsing save time:', e);
                    }
                }
            }
            
            function getTimeAgo(date) {
                const now = new Date();
                const diffMs = now - date;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMs / 3600000);
                const diffDays = Math.floor(diffMs / 86400000);
                
                if (diffMins < 1) return 'just now';
                if (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`;
                if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
                if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
                return date.toLocaleDateString();
            }
            
            // Update last save display
            updateLastSaveDisplay();
            setInterval(updateLastSaveDisplay, 60000); // Update every minute

            // Load draft on page load
            const draft = localStorage.getItem('applicationDraft');
            if (draft) {
                try {
                    const data = JSON.parse(draft);
                    let restoredCount = 0;
                    
                    Object.keys(data).forEach(key => {
                        const field = form.querySelector(`[name="${key}"]`);
                        if (field) {
                            if (field.type === 'checkbox' || field.type === 'radio') {
                                if (Array.isArray(data[key])) {
                                    data[key].forEach(val => {
                                        const option = form.querySelector(`[name="${key}"][value="${val}"]`);
                                        if (option) {
                                            option.checked = true;
                                            restoredCount++;
                                        }
                                    });
                                } else {
                                    const option = form.querySelector(`[name="${key}"][value="${data[key]}"]`);
                                    if (option) {
                                        option.checked = true;
                                        restoredCount++;
                                    }
                                }
                            } else if (field.type !== 'file') {
                                if (data[key]) {
                                    field.value = data[key];
                                    restoredCount++;
                                }
                            }
                        }
                    });
                    
                    if (restoredCount > 0) {
                        updateProgress();
                        // Show restoration message
                        setTimeout(() => {
                            if (globalShowMessage) {
                                globalShowMessage(`Your draft has been restored. ${restoredCount} field(s) loaded.`, 'info');
                            }
                        }, 500);
                    }
                } catch (e) {
                    console.error('Error loading draft:', e);
                }
            }

            // Form validation
            function validateField(field) {
                const errorEl = document.getElementById(field.id + '-error');
                if (!field.checkValidity()) {
                    field.classList.add('error');
                    if (errorEl) {
                        let message = field.validationMessage;
                        // Customize validation messages
                        if (field.validity.valueMissing) {
                            message = 'This field is required';
                        } else if (field.validity.typeMismatch) {
                            if (field.type === 'email') {
                                message = 'Please enter a valid email address';
                            } else if (field.type === 'url') {
                                message = 'Please enter a valid URL (e.g., https://linkedin.com/in/yourprofile)';
                            }
                        } else if (field.validity.tooLong) {
                            message = `Maximum ${field.maxLength} characters allowed`;
                        }
                        errorEl.textContent = message;
                        errorEl.classList.add('show');
                    }
                    return false;
                } else {
                    field.classList.remove('error');
                    if (errorEl) {
                        errorEl.classList.remove('show');
                        errorEl.textContent = '';
                    }
                    return true;
                }
            }

            // Real-time validation
            form.querySelectorAll('input, select, textarea').forEach(field => {
                field.addEventListener('blur', () => {
                    validateField(field);
                    updateProgress();
                });
                field.addEventListener('input', () => {
                    if (field.classList.contains('error')) {
                        validateField(field);
                    }
                    updateProgress();
                    autoSave();
                });
                field.addEventListener('change', () => {
                    validateField(field);
                    updateProgress();
                    autoSave();
                });
            });

            // Show/hide real estate experience section based on CRE experience
            const creExperienceSelect = document.getElementById('creExperience');
            const realEstateSection = document.getElementById('realEstateExperienceSection');
            const transferableSection = document.getElementById('transferableExperienceSection');
            
            if (creExperienceSelect && realEstateSection && transferableSection) {
                creExperienceSelect.addEventListener('change', function() {
                    if (this.value === 'none' || this.value === '') {
                        realEstateSection.style.display = 'none';
                        transferableSection.style.display = 'block';
                        document.getElementById('transactionExperience').removeAttribute('required');
                        document.getElementById('transferableExperience').setAttribute('required', 'required');
                    } else {
                        realEstateSection.style.display = 'block';
                        transferableSection.style.display = 'none';
                        document.getElementById('transactionExperience').setAttribute('required', 'required');
                        document.getElementById('transferableExperience').removeAttribute('required');
                    }
                });
            }

            // File upload handlers
            const videoInput = document.getElementById('video1');
            const resumeInput = document.getElementById('resume');
            const portfolioInput = document.getElementById('portfolio');
            const fileSelected = document.getElementById('fileSelected');
            const resumeSelected = document.getElementById('resumeSelected');
            const portfolioFiles = document.getElementById('portfolioFiles');
            const fileName = document.getElementById('fileName');
            const resumeFileName = document.getElementById('resumeFileName');
            const removeFile = document.getElementById('removeFile');
            const removeResume = document.getElementById('removeResume');

            function getFileIcon(file) {
                const ext = file.name.split('.').pop().toLowerCase();
                if (['jpg', 'jpeg', 'png', 'gif', 'webp'].includes(ext)) return { icon: '', class: 'image', type: 'image' };
                if (ext === 'pdf') return { icon: '', class: 'pdf', type: 'pdf' };
                if (['doc', 'docx'].includes(ext)) return { icon: '', class: 'doc', type: 'document' };
                if (['mp4', 'mov', 'avi', 'wmv', 'webm'].includes(ext)) return { icon: '', class: 'video', type: 'video' };
                if (ext === 'zip') return { icon: '', class: 'zip', type: 'archive' };
                return { icon: '', class: 'doc', type: 'document' };
            }

            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
            }

            function createFilePreview(file, previewContainer, fileType) {
                if (!previewContainer) return;
                
                const fileInfo = getFileIcon(file);
                const fileSize = formatFileSize(file.size);
                const reader = new FileReader();
                
                previewContainer.innerHTML = '';
                previewContainer.classList.add('active');
                
                const previewDiv = document.createElement('div');
                previewDiv.className = 'file-preview';
                
                // Preview header
                const header = document.createElement('div');
                header.className = 'file-preview-header';
                header.innerHTML = `
                    <div class="file-preview-info">
                        <div class="file-preview-icon ${fileInfo.class}">${fileInfo.icon}</div>
                        <div class="file-preview-details">
                            <div class="file-preview-name">${file.name}</div>
                            <div class="file-preview-size">${fileSize}</div>
                        </div>
                    </div>
                    <div class="file-preview-actions">
                        <button type="button" class="file-preview-btn" onclick="openPreviewModal('${file.name}', '${fileInfo.type}')">View</button>
                    </div>
                `;
                
                // Preview content
                const content = document.createElement('div');
                content.className = 'file-preview-content';
                
                if (fileInfo.type === 'image') {
                    reader.onload = (e) => {
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.className = 'file-preview-image';
                        img.onclick = () => openPreviewModal(file.name, 'image', e.target.result);
                        content.appendChild(img);
                    };
                    reader.readAsDataURL(file);
                } else if (fileInfo.type === 'video') {
                    reader.onload = (e) => {
                        const video = document.createElement('video');
                        video.src = e.target.result;
                        video.className = 'file-preview-video';
                        video.controls = true;
                        content.appendChild(video);
                    };
                    reader.readAsDataURL(file);
                } else if (fileInfo.type === 'pdf') {
                    reader.onload = (e) => {
                        const iframe = document.createElement('iframe');
                        iframe.src = e.target.result;
                        iframe.className = 'file-preview-pdf';
                        content.appendChild(iframe);
                    };
                    reader.readAsDataURL(file);
                } else {
                    const placeholder = document.createElement('div');
                    placeholder.className = 'file-preview-placeholder';
                    placeholder.innerHTML = `
                        <div style="text-align: center;">
                            <div style="font-size: 48px; margin-bottom: 12px;">${fileInfo.icon}</div>
                            <div>Preview not available for this file type</div>
                            <div style="font-size: 12px; margin-top: 8px; color: var(--text-light);">Click "View" to download</div>
                        </div>
                    `;
                    content.appendChild(placeholder);
                }
                
                previewDiv.appendChild(header);
                previewDiv.appendChild(content);
                previewContainer.appendChild(previewDiv);
            }

            function setupFileUpload(input, selectedDiv, fileNameEl, removeBtn, maxSize, fileType, previewContainer) {
                if (!input) return;
                
                input.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        if (file.size > maxSize) {
                            showMessage(`File "${file.name}" is too large. Maximum size is ${maxSize / (1024 * 1024)}MB.`, 'error');
                            e.target.value = '';
                            selectedDiv.style.display = 'none';
                            if (previewContainer) {
                                previewContainer.innerHTML = '';
                                previewContainer.classList.remove('active');
                            }
                        } else {
                            fileNameEl.textContent = file.name;
                            selectedDiv.style.display = 'flex';
                            if (previewContainer) {
                                createFilePreview(file, previewContainer, fileType);
                            }
                            updateProgress();
                            autoSave();
                        }
                    } else {
                        selectedDiv.style.display = 'none';
                        if (previewContainer) {
                            previewContainer.innerHTML = '';
                            previewContainer.classList.remove('active');
                        }
                    }
                });

                if (removeBtn) {
                    removeBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        input.value = '';
                        selectedDiv.style.display = 'none';
                        if (previewContainer) {
                            previewContainer.innerHTML = '';
                            previewContainer.classList.remove('active');
                        }
                        updateProgress();
                        autoSave();
                    });
                }
            }

            const videoPreviewContainer = document.getElementById('videoPreview');
            const resumePreviewContainer = document.getElementById('resumePreview');
            
            setupFileUpload(videoInput, fileSelected, fileName, removeFile, 100 * 1024 * 1024, 'video', videoPreviewContainer);
            setupFileUpload(resumeInput, resumeSelected, resumeFileName, removeResume, 10 * 1024 * 1024, 'document', resumePreviewContainer);

            // Portfolio files (multiple files) with previews
            const portfolioPreviewContainer = document.getElementById('portfolioPreview');
            const portfolioFilesList = [];
            
            if (portfolioInput) {
                portfolioInput.addEventListener('change', (e) => {
                    const files = Array.from(e.target.files);
                    portfolioFiles.innerHTML = '';
                    portfolioPreviewContainer.innerHTML = '';
                    portfolioFilesList.length = 0;
                    
                    files.forEach((file, index) => {
                        const maxSize = 10 * 1024 * 1024; // 10MB
                        if (file.size > maxSize) {
                            showMessage(`File "${file.name}" is too large. Maximum size is 10MB.`, 'error');
                            return;
                        }
                        
                        portfolioFilesList.push(file);
                        
                        // Simple list item
                        const fileItem = document.createElement('div');
                        fileItem.className = 'portfolio-file-item';
                        fileItem.innerHTML = `
                            <span class="portfolio-file-name">${file.name}</span>
                            <button type="button" class="portfolio-file-remove" data-index="${index}"></button>
                        `;
                        portfolioFiles.appendChild(fileItem);
                        
                        // Preview card
                        const fileInfo = getFileIcon(file);
                        const fileSize = formatFileSize(file.size);
                        const previewItem = document.createElement('div');
                        previewItem.className = 'portfolio-preview-item';
                        previewItem.setAttribute('data-index', index);
                        
                        const thumbnail = document.createElement('div');
                        thumbnail.className = 'portfolio-preview-thumbnail';
                        
                        if (fileInfo.type === 'image') {
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                const img = document.createElement('img');
                                img.src = e.target.result;
                                img.onclick = () => openPreviewModal(file.name, 'image', e.target.result);
                                thumbnail.appendChild(img);
                            };
                            reader.readAsDataURL(file);
                        } else {
                            thumbnail.innerHTML = `<div class="file-icon-large ${fileInfo.class}">${fileInfo.icon}</div>`;
                            thumbnail.onclick = () => {
                                const reader = new FileReader();
                                reader.onload = (e) => {
                                    if (fileInfo.type === 'pdf') {
                                        openPreviewModal(file.name, 'pdf', e.target.result);
                                    } else if (fileInfo.type === 'video') {
                                        openPreviewModal(file.name, 'video', e.target.result);
                                    }
                                };
                                reader.readAsDataURL(file);
                            };
                            thumbnail.style.cursor = 'pointer';
                        }
                        
                        const footer = document.createElement('div');
                        footer.className = 'portfolio-preview-footer';
                        footer.innerHTML = `
                            <span class="portfolio-preview-name" title="${file.name}">${file.name}</span>
                            <button type="button" class="portfolio-preview-remove" data-index="${index}"></button>
                        `;
                        
                        previewItem.appendChild(thumbnail);
                        previewItem.appendChild(footer);
                        portfolioPreviewContainer.appendChild(previewItem);
                    });
                    autoSave();
                });

                // Handle remove from both lists
                const handleRemove = (index) => {
                    const dt = new DataTransfer();
                    const files = Array.from(portfolioInput.files);
                    files.splice(index, 1);
                    files.forEach(file => dt.items.add(file));
                    portfolioInput.files = dt.files;
                    portfolioInput.dispatchEvent(new Event('change'));
                };

                portfolioFiles.addEventListener('click', (e) => {
                    if (e.target.classList.contains('portfolio-file-remove')) {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        handleRemove(index);
                    }
                });

                portfolioPreviewContainer.addEventListener('click', (e) => {
                    if (e.target.classList.contains('portfolio-preview-remove')) {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        handleRemove(index);
                    }
                });
            }

            function showMessage(text, type) {
                messageDiv.textContent = text;
                messageDiv.className = `message ${type}`;
                messageDiv.style.display = 'block';
                messageDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }

            // Active section tracking with animations
            const observerOptions = {
                root: null,
                rootMargin: '-120px 0px -40% 0px',
                threshold: 0.15
            };

            const sectionObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        const sectionId = entry.target.id;
                        navList.querySelectorAll('.nav-link').forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === `#${sectionId}`) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, observerOptions);

            document.querySelectorAll('.form-section').forEach(section => {
                sectionObserver.observe(section);
            });

            // Fade in sections on scroll with stagger
            const fadeObserver = new IntersectionObserver((entries) => {
                entries.forEach((entry, index) => {
                    if (entry.isIntersecting) {
                        setTimeout(() => {
                            entry.target.classList.add('visible');
                        }, index * 50);
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -100px 0px'
            });

            document.querySelectorAll('.form-section').forEach(section => {
                fadeObserver.observe(section);
            });

            // Smooth scroll for navigation
            navList.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href');
                    const targetSection = document.querySelector(targetId);
                    if (targetSection) {
                        // Close nav sidebar on mobile after clicking
                        if (window.innerWidth <= 768) {
                            const navSidebar = document.getElementById('navSidebar');
                            if (navSidebar) {
                                navSidebar.classList.add('collapsed');
                            }
                        }
                        
                        const offset = window.innerWidth <= 768 ? 140 : 100;
                        const targetPosition = targetSection.getBoundingClientRect().top + window.pageYOffset - offset;
                        window.scrollTo({
                            top: targetPosition,
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Form submission
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                // Validate all fields
                let isValid = true;
                form.querySelectorAll('[required]').forEach(field => {
                    if (!validateField(field)) {
                        isValid = false;
                    }
                });

                // Check design tools
                const designTools = form.querySelectorAll('[name="designTools"]:checked');
                if (designTools.length === 0) {
                    const errorEl = document.getElementById('designTools-error');
                    if (errorEl) {
                        errorEl.textContent = 'Please select at least one design tool';
                        errorEl.classList.add('show');
                    }
                    isValid = false;
                }

                if (!isValid) {
                    showMessage('Please complete all required fields before submitting.', 'error');
                    const firstError = form.querySelector('.error');
                    if (firstError) {
                        firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        firstError.focus();
                    }
                    return;
                }
                
                // Show loading state
                submitBtn.disabled = true;
                submitBtn.classList.add('loading');
                const submitBtnText = document.getElementById('submitBtnText');
                const submitBtnSpinner = document.getElementById('submitBtnSpinner');
                if (submitBtnText) submitBtnText.textContent = 'Submitting...';
                if (submitBtnSpinner) submitBtnSpinner.style.display = 'inline';
                
                // Show upload progress
                showMessage('Uploading files and submitting your application...', 'info');

                // Validate form before submission
                if (!form.checkValidity()) {
                    form.reportValidity();
                    showMessage('Please complete all required fields before submitting.', 'error');
                    submitBtn.disabled = false;
                    submitBtn.classList.remove('loading');
                    if (submitBtnText) submitBtnText.textContent = 'Submit Application';
                    if (submitBtnSpinner) submitBtnSpinner.style.display = 'none';
                    return;
                }

                const formData = new FormData(form);

                try {
                    const response = await fetch('/api/submit-application', {
                        method: 'POST',
                        body: formData
                    });

                    const data = await response.json();

                    if (data.success) {
                        localStorage.removeItem('applicationDraft');
                        // Redirect to success page
                        window.location.href = `/success.html?id=${data.applicationId}`;
                    } else {
                        showMessage(data.message || 'We encountered an error processing your application. Please try again.', 'error');
                        submitBtn.disabled = false;
                        submitBtn.classList.remove('loading');
                        const btnText = document.getElementById('submitBtnText');
                        const btnSpinner = document.getElementById('submitBtnSpinner');
                        if (btnText) btnText.textContent = 'Submit Application';
                        if (btnSpinner) btnSpinner.style.display = 'none';
                    }
                } catch (error) {
                    showMessage('Network error. Please check your connection and try again.', 'error');
                    console.error('Error:', error);
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.classList.remove('loading');
                    const submitBtnText = document.getElementById('submitBtnText');
                    const submitBtnSpinner = document.getElementById('submitBtnSpinner');
                    if (submitBtnText) submitBtnText.textContent = 'Submit Application';
                    if (submitBtnSpinner) submitBtnSpinner.style.display = 'none';
                }
            });

            // Character counters for textareas
            function setupCharCounter(textareaId, maxLength) {
                const textarea = document.getElementById(textareaId);
                const counter = document.getElementById(`${textareaId}-counter`);
                if (textarea && counter) {
                    const updateCounter = () => {
                        const length = textarea.value.length;
                        counter.textContent = `${length} / ${maxLength} characters`;
                        if (length > maxLength * 0.9) {
                            counter.classList.add('warning');
                        } else {
                            counter.classList.remove('warning');
                        }
                        if (length > maxLength) {
                            counter.classList.add('error');
                        } else {
                            counter.classList.remove('error');
                        }
                    };
                    textarea.addEventListener('input', updateCounter);
                    updateCounter(); // Initialize
                }
            }

            // Setup character counters for all textarea fields
            setupCharCounter('transactionCoordination', 3000);
            setupCharCounter('timeManagement', 2500);
            setupCharCounter('careerGoals', 2000);
            setupCharCounter('managementExample', 1500);
            setupCharCounter('accommodations', 1000);
            
            // Show/hide management example section
            const managementExperienceSelect = document.getElementById('managementExperience');
            const managementExampleSection = document.getElementById('managementExampleSection');
            const managementExampleField = document.getElementById('managementExample');
            
            if (managementExperienceSelect && managementExampleSection) {
                managementExperienceSelect.addEventListener('change', function() {
                    if (this.value === 'yes') {
                        managementExampleSection.style.display = 'block';
                        if (managementExampleField) {
                            managementExampleField.setAttribute('required', 'required');
                        }
                    } else {
                        managementExampleSection.style.display = 'none';
                        if (managementExampleField) {
                            managementExampleField.removeAttribute('required');
                            managementExampleField.value = '';
                        }
                    }
                    updateProgress();
                });
            }

            // Initial progress update
            updateProgress();
        });

        // Preview Modal Functions (Global)
        function openPreviewModal(fileName, fileType, dataUrl = null) {
            const modal = document.getElementById('previewModal');
            const modalBody = document.getElementById('previewModalBody');
            
            if (!modal || !modalBody) return;
            
            modalBody.innerHTML = '';
            
            if (fileType === 'image' && dataUrl) {
                const img = document.createElement('img');
                img.src = dataUrl;
                img.style.maxWidth = '100%';
                img.style.height = 'auto';
                modalBody.appendChild(img);
            } else if (fileType === 'video' && dataUrl) {
                const video = document.createElement('video');
                video.src = dataUrl;
                video.controls = true;
                video.style.maxWidth = '100%';
                video.style.height = 'auto';
                modalBody.appendChild(video);
            } else if (fileType === 'pdf' && dataUrl) {
                const iframe = document.createElement('iframe');
                iframe.src = dataUrl;
                iframe.style.width = '100%';
                iframe.style.height = '90vh';
                iframe.style.border = 'none';
                modalBody.appendChild(iframe);
            } else {
                modalBody.innerHTML = `<div style="padding: 40px; text-align: center; color: var(--text-secondary);">Preview not available for ${fileName}</div>`;
            }
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closePreviewModal() {
            const modal = document.getElementById('previewModal');
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
                const modalBody = document.getElementById('previewModalBody');
                if (modalBody) {
                    modalBody.innerHTML = '';
                }
            }
        }
        
        // Close preview modal on outside click
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('previewModal');
            if (modal && e.target === modal) {
                closePreviewModal();
            }
        });
        
        // Close modals on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closePreviewModal();
                if (typeof closeApplicationSummary === 'function') {
                    closeApplicationSummary();
                }
            }
        });
    </script>
</body>
</html>
